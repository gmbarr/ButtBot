!function(){function e(e){return $.inidb.exists("points",e)?parseInt($.inidb.get("points",e)):0}function t(e){return 1==parseInt(e)?e+" "+m:e+" "+l}function s(e){e&&$.commandExists(e.toLowerCase())&&"points"!=e.toLowerCase()&&"point"!=e.toLowerCase()&&$.unregisterChatCommand(e.toLowerCase()),$.commandExists(m.toLowerCase())||e||($.registerChatCommand("./systems/pointSystem.js",m.toLowerCase(),7),$.registerChatSubcommand(m.toLowerCase(),"add",1),$.registerChatSubcommand(m.toLowerCase(),"take",1),$.registerChatSubcommand(m.toLowerCase(),"set",1),$.registerChatSubcommand(m.toLowerCase(),"all",1),$.registerChatSubcommand(m.toLowerCase(),"setname",1),$.registerChatSubcommand(m.toLowerCase(),"setgain",1),$.registerChatSubcommand(m.toLowerCase(),"setofflinegain",1),$.registerChatSubcommand(m.toLowerCase(),"setinterval",1)),$.commandExists(l.toLowerCase())||e||($.registerChatCommand("./systems/pointSystem.js",l.toLowerCase(),7),$.registerChatSubcommand(l.toLowerCase(),"add",1),$.registerChatSubcommand(l.toLowerCase(),"take",1),$.registerChatSubcommand(l.toLowerCase(),"set",1),$.registerChatSubcommand(l.toLowerCase(),"all",1),$.registerChatSubcommand(l.toLowerCase(),"setname",1),$.registerChatSubcommand(l.toLowerCase(),"setgain",1),$.registerChatSubcommand(l.toLowerCase(),"setofflinegain",1),$.registerChatSubcommand(l.toLowerCase(),"setinterval",1))}function i(){var e,t,s,i=$.systemTime(),g=[];if($.bot.isModuleEnabled("./systems/pointSystem.js")){if($.isOnline($.channelName)){if(!(o>0&&i>=p+6e4*o))return;t=n}else{if(!(a>0&&i>=p+6e4*a))return;t=r}for(s in $.users)e=$.users[s][0].toLowerCase(),$.isOnline($.channelName)?$.inidb.exists("grouppoints",$.getUserGroupId(e))&&(t=parseInt($.inidb.get("grouppoints",$.getUserGroupId(e)))<0?n:parseInt($.inidb.get("grouppoints",$.getUserGroupId(e)))):$.inidb.exists("grouppointsoffline",$.getUserGroupId(e))&&(t=parseInt($.inidb.get("grouppointsoffline",$.getUserGroupId(e)))<0?r:parseInt($.inidb.get("grouppointsoffline",$.getUserGroupId(e)))),$.inidb.incr("points",e,t),g.push(e);$.log("pointSystem","Executed "+l+" payouts. Users: "+(g.length>0?g.join(", "):"none")),p=i}}var n=($.getIniDbBoolean("pointSettings","pointsTimedGain")?$.getIniDbBoolean("pointSettings","pointsTimedGain"):!0,$.inidb.exists("pointSettings","onlineGain")?parseInt($.inidb.get("pointSettings","onlineGain")):1),r=$.inidb.exists("pointSettings","offlineGain")?parseInt($.inidb.get("pointSettings","offlineGain")):1,o=$.inidb.exists("pointSettings","onlinePayoutInterval")?parseInt($.inidb.get("pointSettings","onlinePayoutInterval")):10,a=$.inidb.exists("pointSettings","offlinePayoutInterval")?parseInt($.inidb.get("pointSettings","offlinePayoutInterval")):0,g=$.getIniDbBoolean("pointSettings","modPointsPermToggle")?$.getIniDbBoolean("pointSettings","modPointsPermToggle"):!1,p=0,m=$.inidb.exists("pointSettings","pointNameSingle")?$.inidb.get("pointSettings","pointNameSingle"):"Point",l=$.inidb.exists("pointSettings","pointNameMultiple")?$.inidb.get("pointSettings","pointNameMultiple"):"Points";$.bind("command",function(i){var p,u,d=i.getSender().toLowerCase(),f=$.username.resolve(d,i.getTags()),y=i.getCommand(),C=i.getArgs(),c=C[0],h=C[1],S=C[2];if(y.equalsIgnoreCase("points")||y.equalsIgnoreCase("point")||y.equalsIgnoreCase(l)||y.equalsIgnoreCase(m))if(c){if(c.equalsIgnoreCase("add")){if(h=(h+"").toLowerCase(),S=parseInt(S),isNaN(S))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.add.usage"));if(!h||!$.user.isKnown(h))return void $.say($.whisperPrefix(d)+$.lang.get("common.user.404",h));if(0>S)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.add.error.negative",l));$.user.isKnown(h)&&($.inidb.incr("points",h,S),$.say($.lang.get("pointsystem.add.success",$.getPointsString(S),$.username.resolve(h),$.getPointsString($.getUserPoints(h)))))}if(c.equalsIgnoreCase("take")){if(h=(h+"").toLowerCase(),S=parseInt(S),isNaN(S))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.take.usage"));if(!h||!$.user.isKnown(h))return void $.say($.whisperPrefix(d)+$.lang.get("common.user.404",h));if(S>$.getUserPoints(h))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.take.error.toomuch",f,l));$.inidb.decr("points",h,S),$.say($.lang.get("pointsystem.take.success",$.getPointsString(S),$.username.resolve(h),$.getPointsString($.getUserPoints(h))))}if(c.equalsIgnoreCase("set")){if(h=(h+"").toLowerCase(),S=parseInt(S),isNaN(S))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.setbalance.usage"));if(!h||!$.user.isKnown(h))return void $.say($.whisperPrefix(d)+$.lang.get("common.user.404",h));if(0>S)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.setbalance.error.negative",l));$.inidb.set("points",h,S),$.say($.lang.get("pointsystem.setbalance.success",m,$.username.resolve(h),$.getPointsString($.getUserPoints(h))))}if(c.equalsIgnoreCase("all")){if(!h)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.add.all.usage"));if(h=parseInt(h),0>h)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.add.error.negative",l));for(u in $.users)$.inidb.incr("points",$.users[u][0].toLowerCase(),h);$.say($.lang.get("pointsystem.add.all.success",$.getPointsString(h)))}if(c.equalsIgnoreCase("setname")){if("single"==h&&S)return p=m,m=S,$.inidb.set("pointSettings","pointNameSingle",m),s(p),s(),void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.name.single.success",p,m));if("multiple"==h&&S)return p=l,l=S,$.inidb.set("pointSettings","pointNameMultiple",l),s(p),s(),void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.name.multiple.success",p,l));if("delete"==h)return $.inidb.del("pointSettings","pointNameSingle"),$.inidb.del("pointSettings","pointNameMultiple"),s(m),s(l),m="Point",l="Points",void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.name.delete"));$.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.name.usage"))}if(c.equalsIgnoreCase("setgain")){if(h=parseInt(h),isNaN(h))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.gain.usage"));if(0>h)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.gain.error.negative",l));n=h,$.inidb.set("pointSettings","onlineGain",n),$.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.gain.success",m,$.getPointsString(n),o))}if(c.equalsIgnoreCase("setofflinegain")){if(h=parseInt(h),isNaN(h))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.gain.offline.usage"));if(0>h)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.gain.error.negative",l));r=h,$.inidb.set("pointSettings","offlineGain",r),$.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.gain.offline.success",m,$.getPointsString(r),a))}if(c.equalsIgnoreCase("setinterval")){if(h=parseInt(h),isNaN(h))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.interval.usage"));if(0>h)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.interval.error.negative",l));o=h,$.inidb.set("pointSettings","onlinePayoutInterval",o),$.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.interval.success",m,o))}if(c.equalsIgnoreCase("setofflineinterval")){if(h=parseInt(h),isNaN(h))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.interval.offline.usage"));if(0>h)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.interval.error.negative",l));a=h,$.inidb.set("pointSettings","offlinePayoutInterval",a),$.say($.whisperPrefix(d)+$.lang.get("pointsystem.set.interval.offline.success",m,a))}c.equalsIgnoreCase("modpermtoggle")&&(g=!g,$.setIniDbBoolean("pointSettings","modPointsPermToggle",g),$.say($.whisperPrefix(d)+$.lang.get("pointsystem.modpermtoggle.success",g?"moderator":"administrator")))}else 0==$.getUserPoints(d)?$.say($.whisperPrefix(d)+$.lang.get("pointsystem.get.self.nopoints",l)):$.say($.whisperPrefix(d)+$.lang.get("pointsystem.get.self.withtime",$.resolveRank(d),$.getPointsString($.getUserPoints(d)),$.getUserTimeString(d)));if(y.equalsIgnoreCase("makeitrain")){if(!$.isAdmin(d))return void $.say($.whisperPrefix(d)+$.adminMsg);if(c=parseInt(c),isNaN(c))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.makeitrain.usage"));if(1>c)return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.makeitrain.error.negative",l));for(u in $.users){var b=$.randRange(1,c);p=[],$.inidb.incr("points",$.users[u][0].toLowerCase(),b),$.users[u][0].equalsIgnoreCase($.botName)||p.push($.username.resolve($.users[u][0])+": "+$.getPointsString(b))}p.length>0&&$.say($.lang.get("pointsystem.makeitrain.success",f,l,p.join(", ")))}if(y.equalsIgnoreCase("gift")){if(!C[0]||!C[1])return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.gift.usage"));if(parseInt(C[1])>e(d))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.gift.shortpoints"));if(!$.user.isKnown(C[0].toLowerCase()))return void $.say($.whisperPrefix(d)+$.lang.get("pointsystem.gift.404"));$.inidb.incr("points",C[0].toLowerCase(),parseInt(C[1])),$.inidb.decr("points",d,parseInt(C[1])),$.say($.lang.get("pointsystem.gift.success",$.username.resolve(d),t(parseInt(C[1])),$.username.resolve(C[0])))}}),setInterval(function(){i()},6e4),$.bind("initReady",function(){$.bot.isModuleEnabled("./systems/pointSystem.js")&&($.registerChatCommand("./systems/pointSystem.js","makeitrain",2),$.registerChatCommand("./systems/pointSystem.js","points",7),$.registerChatCommand("./systems/pointSystem.js","point",7),$.registerChatCommand("./systems/pointSystem.js","gift",7),$.registerChatSubcommand("points","add",1),$.registerChatSubcommand("points","take",1),$.registerChatSubcommand("points","set",1),$.registerChatSubcommand("points","all",1),$.registerChatSubcommand("points","setname",1),$.registerChatSubcommand("points","setgain",1),$.registerChatSubcommand("points","setofflinegain",1),$.registerChatSubcommand("points","setinterval",1),s())}),$.pointNameSingle=m,$.pointNameMultiple=l,$.getUserPoints=e,$.getPointsString=t}();