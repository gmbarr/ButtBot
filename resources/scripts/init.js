!function(){function e(e,s,i){this.scriptFile=e,this.script=s,this.enabled=i,e.indexOf("./core/")>-1&&(this.enabled=!0),this.getModuleName=function(){return this.scriptFile.replace(/([a-z]+)\.js$/i,"$1")}}function s(e,s,i){this.scriptFile=e,this.hook=s,this.handler=i}function i(e){Packages.com.gmt2001.Console.out.println(java.util.Objects.toString(e))}function t(){var e,s=function(e){var s,i=["getClass","equals","notify","class","hashCode","toString","wait","notifyAll"];for(s in i)if(i[s]==e)return!0;return!1},i=function(e,s){return function(){for(var i=[$script],t=0;t<arguments.length;t++)i.push(arguments[t]);e[s].save(e,i)}};for(e in $api)s(e)||($[e]="function"==typeof $api[e]?i($api,e):$api[e])}function n(s,t,n){if(!g(s)||t)try{var r,a=$api.loadScriptR($script,s);$.inidb.exists("modules",s)?r=$.getIniDbBoolean("modules",s):(r=!0,$.setIniDbBoolean("modules",s,r)),h.push(new e(s,a,r)),n||i("Loaded module: "+s.replace(/\.\//g,"")+" ("+(r?"Enabled":"Disabled")+")")}catch(o){i('Failed loading "'+s+'": '+o),g("./core/logging.js")&&$.logError("init.js",70,"(loadScript, "+s+") "+o)}}function r(e,s){e.substring($.strlen(e)-1).equalsIgnoreCase("/")&&(e=e.substring(0,$.strlen(e)-1));var i,t=$.findFiles("./scripts/"+e,"");for(i=0;i<t.length;i++)e.equalsIgnoreCase(".")&&(t[i].equalsIgnoreCase("util")||t[i].equalsIgnoreCase("lang")||t[i].equalsIgnoreCase("init.js")||t[i].equalsIgnoreCase("dev"))||($.isDirectory("./scripts/"+e+"/"+t[i])?r(e+"/"+t[i],s):n(e+"/"+t[i],!1,s))}function a(e){var s;for(s in h)if(h[s].scriptFile.equalsIgnoreCase(e))return s;return-1}function o(e){var s=a(e);return s>-1?h[s].enabled:!1}function g(e){return a(e)>-1}function d(e){var s=a(e);return s>-1?h[s]:null}function u(e,s){var i;for(i in v)if(v[i].scriptFile.equalsIgnoreCase(e)&&v[i].hook.equalsIgnoreCase(s))return i;return-1}function l(e,i){var t=$script.getPath().replace("\\","/").replace("./scripts/",""),n=u(t,e);n>-1?v[n].handler=i:v.push(new s(t,e,i))}function m(e){var s=$script.getPath().replace("\\","/").replace("./scripts/",""),i=u(s,e);i>-1&&v.splice(i,1)}function c(e,s,i){var t;for(t in v)if(v[t].hook.equalsIgnoreCase(e)&&(o(v[t].scriptFile)||i))try{v[t].handler(s)}catch(n){$.logError("init.js",173,"(hook.call, "+e+", "+v[t].scriptFile+") "+n)}}function p(){t(),n("./core/misc.js"),n("./core/jsTimers.js"),n("./core/updates.js"),n("./core/fileSystem.js"),n("./core/lang.js"),n("./core/logging.js"),n("./core/commandRegister.js"),n("./core/whisper.js"),n("./core/chatModerator.js"),n("./core/commandCoolDown.js"),n("./core/gameMessages.js"),n("./core/patternDetector.js"),n("./core/permissions.js"),n("./core/streamInfo.js"),n("./core/pointSystem.js"),n("./core/ranks.js"),n("./core/timeSystem.js"),$.logEvent("init.js",285,"Core loaded, initializing bot..."),r("."),$api.on($script,"ircChannelMessage",function(e){i($.username.resolve(e.getSender().toLowerCase(),e.getTags())+": "+e.getMessage()),e.getSender().equalsIgnoreCase("jtv")||e.getSender().equalsIgnoreCase("twitchnotify")?c("ircPrivateMessage",e,!1):c("ircChannelMessage",e,!1)}),$api.on($script,"ircJoinComplete",function(e){f=!0,$.channel=e.getChannel()}),$api.on($script,"ircChannelUserMode",function(e){f&&e.getChannel().getName().equalsIgnoreCase($.channel.getName())&&e.getUser().equalsIgnoreCase($.botName)&&e.getMode().equalsIgnoreCase("o")&&e.getAdd()&&(b||$.consoleLn($.username.resolve($.botName)+" is ready to receive commands!"),b=!0)}),$api.on($script,"command",function(e){var s,i,t=e.getSender().toLowerCase(),n=e.getTags(),r=e.getCommand().toLowerCase();if(($.isModv3(t,n)||!$.commandPause.isPaused())&&($.inidb.exists("aliases",r)&&e.setCommand($.inidb.get("aliases",r)),i=e.getCommand().toLowerCase(),$.commandExists(i))){if(!$.permCom(t,i))return void $.say($.whisperPrefix(t)+$.lang.get("cmd.noperm",i));if($.isAdmin(t)||(s=$.coolDown.get(i,t),0>=s)){if(o("./core/pointSystem.js")&&!$.isModv3(t,e.getTags())&&$.inidb.exists("pricecom",i)){if($.getUserPoints(t)<$.getCommandPrice(i))return void $.say($.whisperPrefix(t)+$.lang.get("cmd.needpoints",$.getPointsString($.inidb.get("pricecom",i))));parseInt($.inidb.get("pricecom",i))>0&&$.inidb.decr("points",t,$.inidb.get("pricecom",i))}c("command",e,!1)}}}),$api.on($script,"consoleInput",function(e){c("consoleInput",e,!0)}),$api.on($script,"twitchFollow",function(e){c("twitchFollow",e,!0)}),$api.on($script,"twitchUnfollow",function(e){c("twitchUnfollow",e,!0)}),$api.on($script,"twitchFollowsInitialized",function(e){c("twitchFollowsInitialized",e,!0)}),$api.on($script,"twitchHosted",function(e){c("twitchHosted",e,!0)}),$api.on($script,"twitchUnhosted",function(e){c("twitchUnhosted",e,!0)}),$api.on($script,"twitchHostsInitialized",function(e){c("twitchHostsInitialized",e,!0)}),$api.on($script,"twitchSubscribe",function(e){c("twitchSubscribe",e,!0)}),$api.on($script,"twitchUnsubscribe",function(e){c("twitchUnsubscribe",e,!0)}),$api.on($script,"twitchSubscribesInitialized",function(e){c("twitchSubscribesInitialized",e,!0)}),$api.on($script,"ircChannelJoin",function(e){c("ircChannelJoin",e,!0)}),$api.on($script,"ircChannelLeave",function(e){c("ircChannelLeave",e,!0)}),$api.on($script,"ircChannelUserMode",function(e){c("ircChannelUserMode",e,!0)}),$api.on($script,"ircConnectComplete",function(e){c("ircConnectComplete",e,!0)}),$api.on($script,"ircJoinComplete",function(e){c("ircJoinComplete",e,!0)}),$api.on($script,"ircPrivateMessage",function(e){c("ircPrivateMessage",e,!1)}),$api.on($script,"musicPlayerConnect",function(e){c("musicPlayerConnect",e,!1)}),$api.on($script,"musicPlayerCurrentId",function(e){c("musicPlayerCurrentId",e,!1)}),$api.on($script,"musicPlayerCurrentVolume",function(e){c("musicPlayerCurrentVolume",e,!1)}),$api.on($script,"musicPlayerDisconnect",function(e){c("musicPlayerDisconnect",e,!1)}),$api.on($script,"musicPlayerState",function(e){c("musicPlayerState",e,!1)}),$.logEvent("init.js",534,"Bot locked & loaded!"),$.consoleLn("Bot locked & loaded!"),$api.on($script,"command",function(e){var s,i,t=e.getSender().toLowerCase(),r=$.username.resolve(t,e.getTags()),o=e.getCommand(),g=e.getArgs(),d=g[0];if(o.equalsIgnoreCase("reconnect")){if(!$.isModv3(t,e.getTags()))return void $.say($.whisperPrefix(t)+$.modMsg);$.logEvent("init.js",354,r+" requested a reconnect!"),$.connmgr.reconnectSession($.hostname),$.say($.lang.get("init.reconnect"))}if(o.equalsIgnoreCase("module")){if(!$.isAdmin(t))return void $.say($.whisperPrefix(t)+$.adminMsg);if(!d)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));if(d.equalsIgnoreCase("list")){s=[];for(i in h)h[i].enabled&&s.push(h[i].getModuleName());$.say($.whisperPrefix(t)+$.lang.get("init.module.list",s.length,s.join(", ")))}if(d.equalsIgnoreCase("enable")){if(s=g[1],!s)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));if(s.indexOf("./core/")>-1||s.indexOf("./lang/")>-1)return;i=a(s),i>-1?($.logEvent("init.js",393,r+' enabled module "'+h[i].scriptFile+'"'),h[i].enabled=!0,$.setIniDbBoolean("modules",h[i].scriptFile,!0),n(h[i].scriptFile,!0),c("initReady",null,!0),$.say($.whisperPrefix(t)+$.lang.get("init.module.enabled",h[i].getModuleName()))):$.say($.whisperPrefix(t)+$.lang.get("init.module.404"))}if(d.equalsIgnoreCase("disable")){if(s=g[1],!s)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));if(s.indexOf("./core/")>-1||s.indexOf("./lang/")>-1)return;i=a(s),i>-1?($.logEvent("init.js",393,r+' disabled module "'+h[i].scriptFile+'"'),h[i].enabled=!1,$.setIniDbBoolean("modules",h[i].scriptFile,!1),$.say($.whisperPrefix(t)+$.lang.get("init.module.disabled",h[i].getModuleName()))):$.say($.whisperPrefix(t)+$.lang.get("init.module.404"))}if(d.equalsIgnoreCase("status")){if(s=g[1],!s)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));i=a(s),$.say(i>1?h[i].enabled?$.whisperPrefix(t)+$.lang.get("init.module.check.enabled",h[i].getModuleName()):$.whisperPrefix(t)+$.lang.get("init.module.check.disabled",h[i].getModuleName()):$.whisperPrefix(t)+$.lang.get("init.module.404"))}}o.equalsIgnoreCase("chat")&&$.say(e.getArguments())}),$.registerChatCommand("./init.js","chat",1),$.registerChatCommand("./init.js","module",1),$.registerChatCommand("./init.js","reconnect",2),c("initReady",null,!0)}var f=!1,b=!1,h=[],v=[];$.consoleLn=i,$.bind=l,$.unbind=m,$.bot={loadScript:n,loadScriptRecursive:r,isModuleLoaded:g,isModuleEnabled:o,getModule:d},p()}();
