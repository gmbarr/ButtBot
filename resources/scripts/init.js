!function(){function e(e,i,n){this.scriptFile=e,this.script=i,this.enabled=n,e.indexOf("./core/")>-1&&(this.enabled=!0),this.getModuleName=function(){return this.scriptFile.replace(/([a-z]+)\.js$/i,"$1")}}function i(e,i,n){this.scriptFile=e,this.hook=i,this.handler=n}function n(e){Packages.com.gmt2001.Console.out.println(java.util.Objects.toString(e))}function t(e){Packages.com.gmt2001.Console.debug.println(java.util.Objects.toString(e))}function s(){var e,i=function(e){var i,n=["getClass","equals","notify","class","hashCode","toString","wait","notifyAll"];for(i in n)if(n[i]==e)return!0;return!1},n=function(e,i){return function(){for(var n=[$script],t=0;t<arguments.length;t++)n.push(arguments[t]);e[i].save(e,n)}};for(e in $api)i(e)||("function"==typeof $api[e]?$[e]=n($api,e):$[e]=$api[e])}function r(i,t,s){if(!c(i)||t){if(!i.endsWith(".js"))return;try{var r,o=$api.loadScriptR($script,i);$.inidb.exists("modules",i)?r=$.getIniDbBoolean("modules",i):(r=!0,$.setIniDbBoolean("modules",i,r)),P.push(new e(i,o,r)),s||n("Loaded module: "+i.replace(/\.\//g,"")+" ("+(r?"Enabled":"Disabled")+")")}catch(a){n('Failed loading "'+i+'": '+a),c("./core/logging.js")&&$.logError("init.js",70,"(loadScript, "+i+") "+a)}}}function o(e,i){e.substring($.strlen(e)-1).equalsIgnoreCase("/")&&(e=e.substring(0,$.strlen(e)-1));var n,t=$.findFiles("./scripts/"+e,"");for(n=0;n<t.length;n++)e.equalsIgnoreCase(".")&&(t[n].equalsIgnoreCase("util")||t[n].equalsIgnoreCase("lang")||t[n].equalsIgnoreCase("init.js")||t[n].equalsIgnoreCase("dev"))||($.isDirectory("./scripts/"+e+"/"+t[n])?o(e+"/"+t[n],i):r(e+"/"+t[n],!1,i))}function a(e){var i;for(i in P)if(P[i].scriptFile.equalsIgnoreCase(e))return i;return-1}function l(e){var i=a(e);return i>-1?P[i].enabled:!1}function c(e){return a(e)>-1}function u(e){var i=a(e);return i>-1?P[i]:null}function p(e,i){var n;for(n in b)if(b[n].scriptFile.equalsIgnoreCase(e)&&b[n].hook.equalsIgnoreCase(i))return n;return-1}function d(e,n){var t=$script.getPath().replace("\\","/").replace("./scripts/",""),s=p(t,e);s>-1?b[s].handler=n:b.push(new i(t,e,n))}function g(e){var i=$script.getPath().replace("\\","/").replace("./scripts/",""),n=p(i,e);n>-1&&b.splice(n,1)}function m(e,i,n){var t;if("command"==e){var t=p(getCommandScript(i.getCommand()),e);if(-1==t)return;if(l(b[t].scriptFile)||n)try{b[t].handler(i)}catch(s){$.logError("init.js",265,"(hook.call, "+e+", "+b[t].scriptFile+") "+s)}}else for(t in b)if(b[t].hook.equalsIgnoreCase(e)&&(l(b[t].scriptFile)||n))try{b[t].handler(i)}catch(s){$.logError("init.js",274,"(hook.call, "+e+", "+b[t].scriptFile+") "+s)}}function f(e){var i,n,t=e.getSender().toLowerCase(),s=$.username.resolve(t,e.getTags()),o=e.getCommand(),l=e.getArgs(),c=l[0],u=[];if(o.equalsIgnoreCase("reconnect")){if(!$.isModv3(t,e.getTags()))return void $.say($.whisperPrefix(t)+$.modMsg);$.logEvent("init.js",354,s+" requested a reconnect!"),$.connmgr.reconnectSession($.hostname),$.say($.lang.get("init.reconnect"))}if(o.equalsIgnoreCase("module")){if(!$.isAdmin(t))return void $.say($.whisperPrefix(t)+$.adminMsg);if(!c)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));if(!c)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));if(c.equalsIgnoreCase("list")){var d="";for(n in P)-1==P[n].scriptFile.indexOf("./core/")&&-1==P[n].scriptFile.indexOf("./lang/")&&(d+=" - ",d+=P[n].scriptFile+" (",d+=P[n].enabled?"enabled":"disabled",d+=")");$.say($.whisperPrefix(t)+d)}if(c.equalsIgnoreCase("enable")){if(i=l[1],!i)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));if(i.indexOf("./core/")>-1||i.indexOf("./lang/")>-1)return;if(n=a(i),n>-1){$.logEvent("init.js",393,s+' enabled module "'+P[n].scriptFile+'"'),P[n].enabled=!0,$.setIniDbBoolean("modules",P[n].scriptFile,!0),r(P[n].scriptFile);var g=p(P[n].scriptFile,"initReady");try{b[g].handler(null),$.say($.whisperPrefix(t)+$.lang.get("init.module.enabled",P[n].getModuleName()))}catch(m){$.logError("init.js",394,"Unable to call initReady for enabled module ("+P[n].scriptFile+"): "+m),$.say($.whisperPrefix(t)+$.lang.get("init.module.error",P[n].getModuleName()))}}else $.say($.whisperPrefix(t)+$.lang.get("init.module.404"))}if(c.equalsIgnoreCase("disable")){if(i=l[1],!i)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));if(i.indexOf("./core/")>-1||i.indexOf("./lang/")>-1)return;if(n=a(i),n>-1){if($.logEvent("init.js",393,s+' disabled module "'+P[n].scriptFile+'"'),P[n].enabled=!1,$.setIniDbBoolean("modules",P[n].scriptFile,!1),$.say($.whisperPrefix(t)+$.lang.get("init.module.disabled",P[n].getModuleName())),"./systems/pointSystem.js"==P[n].scriptFile){u.push("./games/adventureSystem.js"),u.push("./games/roll.js"),u.push("./games/slotMachine.js"),u.push("./systems/ticketRaffleSystem.js"),u.push("./systems/raffleSystem.js");for(var f=0;f<u.length;f++)n=a(u[f]),n>-1&&($.logEvent("init.js",393,s+' auto-disabled module "'+P[n].scriptFile+'"'),P[n].enabled=!1,$.setIniDbBoolean("modules",P[n].scriptFile,!1));$.say($.whisperPrefix(t)+$.lang.get("init.module.auto-disabled"))}}else $.say($.whisperPrefix(t)+$.lang.get("init.module.404"))}if(c.equalsIgnoreCase("status")){if(i=l[1],!i)return void $.say($.whisperPrefix(t)+$.lang.get("init.module.usage"));n=a(i),n>1?P[n].enabled?$.say($.whisperPrefix(t)+$.lang.get("init.module.check.enabled",P[n].getModuleName())):$.say($.whisperPrefix(t)+$.lang.get("init.module.check.disabled",P[n].getModuleName())):$.say($.whisperPrefix(t)+$.lang.get("init.module.404"))}}if(o.equalsIgnoreCase("chat")){if(!$.isAdmin(t))return void $.say($.whisperPrefix(t)+$.adminMsg);$.say(e.getArguments())}}function h(){s(),r("./core/misc.js"),r("./core/jsTimers.js"),r("./core/updates.js"),r("./core/fileSystem.js"),r("./core/lang.js"),r("./core/logging.js"),r("./core/commandRegister.js"),r("./core/whisper.js"),r("./core/chatModerator.js"),r("./core/commandCoolDown.js"),r("./core/gameMessages.js"),r("./core/patternDetector.js"),r("./core/permissions.js"),r("./core/streamInfo.js"),r("./core/timeSystem.js"),$.logEvent("init.js",285,"Core loaded, initializing bot..."),o("."),$api.on($script,"ircChannelMessage",function(e){n($.username.resolve(e.getSender().toLowerCase(),e.getTags())+": "+e.getMessage()),e.getSender().equalsIgnoreCase("jtv")||e.getSender().equalsIgnoreCase("twitchnotify")?m("ircPrivateMessage",e,!1):(m("ircChannelMessage",e,!1),$.bot.isModuleEnabled("./handlers/panelHandler.js")&&$.panelDB.updateChatLinesDB())}),$api.on($script,"ircJoinComplete",function(e){y=!0,$.channel=e.getChannel()}),$api.on($script,"ircChannelUserMode",function(e){y&&e.getChannel().getName().equalsIgnoreCase($.channel.getName())&&e.getUser().equalsIgnoreCase($.botName)&&e.getMode().equalsIgnoreCase("o")&&e.getAdd()&&(C||n($.username.resolve($.botName)+" ready!"),C=!0)}),$api.on($script,"command",function(e){var i,n,s,r=e.getSender(),o=e.getArgs(),a=e.getCommand();if(!$.isModv3(r,e.getTags())&&$.commandPause.isPaused())return void t($.lang.get("commandpause.isactive"));if($.inidb.exists("aliases",a)&&e.setCommand($.inidb.get("aliases",a)),i=e.getCommand().toLowerCase(),!$.commandExists(i))return void t("that command does not exists.");if(!$.isAdmin(r)&&parseInt($.coolDown.get(i,r))>0)return void t("command "+i+" was not sent because it is still on a cooldown.");if(n=o[0]?o[0]:"",0!=(s=$.permCom(r,i,n)))return void(1==s?$.say($.whisperPrefix(r)+$.lang.get("cmd.perm.404",$.getCommandGroupName(i))):$.say($.whisperPrefix(r)+$.lang.get("cmd.perm.404",$.getSubCommandGroupName(i,n))));if(l("./systems/pointSystem.js")&&!$.isModv3(r,e.getTags())&&$.inidb.exists("pricecom",i)){if($.getUserPoints(r)<$.getCommandPrice(i))return void $.say($.whisperPrefix(r)+$.lang.get("cmd.needpoints",$.getPointsString($.inidb.get("pricecom",i))));parseInt($.inidb.get("pricecom",i))>0&&$.inidb.decr("points",r,$.inidb.get("pricecom",i))}m("command",e,!1),f(e)}),$api.on($script,"consoleInput",function(e){m("consoleInput",e,!0)}),$api.on($script,"twitchFollow",function(e){m("twitchFollow",e,!0)}),$api.on($script,"twitchUnfollow",function(e){m("twitchUnfollow",e,!0)}),$api.on($script,"twitchFollowsInitialized",function(e){m("twitchFollowsInitialized",e,!0)}),$api.on($script,"twitchHosted",function(e){m("twitchHosted",e,!0)}),$api.on($script,"twitchUnhosted",function(e){m("twitchUnhosted",e,!0)}),$api.on($script,"twitchHostsInitialized",function(e){m("twitchHostsInitialized",e,!0)}),$api.on($script,"twitchSubscribe",function(e){m("twitchSubscribe",e,!0)}),$api.on($script,"twitchUnsubscribe",function(e){m("twitchUnsubscribe",e,!0)}),$api.on($script,"twitchSubscribesInitialized",function(e){m("twitchSubscribesInitialized",e,!0)}),$api.on($script,"ircChannelJoin",function(e){m("ircChannelJoin",e,!0)}),$api.on($script,"ircChannelLeave",function(e){m("ircChannelLeave",e,!0)}),$api.on($script,"ircChannelUserMode",function(e){m("ircChannelUserMode",e,!0)}),$api.on($script,"ircConnectComplete",function(e){m("ircConnectComplete",e,!0)}),$api.on($script,"ircJoinComplete",function(e){m("ircJoinComplete",e,!0)}),$api.on($script,"ircPrivateMessage",function(e){m("ircPrivateMessage",e,!1)}),$api.on($script,"musicPlayerConnect",function(e){m("musicPlayerConnect",e,!1)}),$api.on($script,"musicPlayerCurrentId",function(e){m("musicPlayerCurrentId",e,!1)}),$api.on($script,"musicPlayerCurrentVolume",function(e){m("musicPlayerCurrentVolume",e,!1)}),$api.on($script,"musicPlayerDisconnect",function(e){m("musicPlayerDisconnect",e,!1)}),$api.on($script,"musicPlayerState",function(e){m("musicPlayerState",e,!1)}),$api.on($script,"twitchAlertsDonation",function(e){m("twitchAlertsDonation",e,!0)}),$api.on($script,"emotesGet",function(e){m("emotesGet",e,!0)}),$api.on($script,"ircChannelJoinUpdate",function(e){m("ircChannelJoinUpdate",e,!0)}),$api.on($script,"yTPlayerConnect",function(e){m("yTPlayerConnect",e,!1)}),$api.on($script,"yTPlayerDisconnect",function(e){m("yTPlayerDisconnect",e,!1)}),$api.on($script,"yTPlayerState",function(e){m("yTPlayerState",e,!1)}),$api.on($script,"yTPlayerCurrentId",function(e){m("yTPlayerCurrentId",e,!1)}),$api.on($script,"yTPlayerRequestSonglist",function(e){m("yTPlayerRequestSonglist",e,!1)}),$api.on($script,"yTPlayerRequestPlaylist",function(e){m("yTPlayerRequestPlaylist",e,!1)}),$api.on($script,"yTPlayerDeleteSR",function(e){m("yTPlayerDeleteSR",e,!1)}),$api.on($script,"yTPlayerVolume",function(e){m("yTPlayerVolume",e,!1)}),$api.on($script,"yTPlayerSkipSong",function(e){m("yTPlayerSkipSong",e,!1)}),$api.on($script,"yTPlayerStealSong",function(e){m("yTPlayerStealSong",e,!1)}),$api.on($script,"yTPlayerSongRequest",function(e){m("yTPlayerSongRequest",e,!1)}),$api.on($script,"yTPlayerDeletePlaylistByID",function(e){m("yTPlayerDeletePlaylistByID",e,!1)}),$api.on($script,"gameWispChange",function(e){m("gameWispChange",e,!1)}),$api.on($script,"gameWispBenefits",function(e){m("gameWispBenefits",e,!1)}),$api.on($script,"gameWispSubscribe",function(e){m("gameWispSubscribe",e,!1)}),$api.on($script,"gameWispAnniversary",function(e){m("gameWispAnniversary",e,!1)}),$.logEvent("init.js",553,"Bot locked & loaded!"),t("Bot locked & loaded!"),n(""),$.registerChatCommand("./init.js","chat",1),$.registerChatCommand("./init.js","module",1),$.registerChatCommand("./init.js","reconnect",1),m("initReady",null,!0)}var y=!1,C=!1,P=[],b=[];$.consoleLn=n,$.consoleDebug=t,$.bind=d,$.unbind=g,$.bot={loadScript:r,loadScriptRecursive:o,isModuleLoaded:c,isModuleEnabled:l,getModule:u},h()}();
