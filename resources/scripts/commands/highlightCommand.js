!function(){$.bind("command",function(i){var h,g,e,t,s,n,a,l=i.getCommand(),m=i.getSender(),d=i.getArgs();if(l.equalsIgnoreCase("highlight")){if(!$.isOnline($.channelName))return void $.say($.whisperPrefix(m)+$.lang.get("highlightcommand.highlight.offline"));if(0==d.length)return void $.say($.whisperPrefix(m)+$.lang.get("highlightcommand.highlight.usage",$.inidb.exists("settings","timezone")?$.inidb.get("settings","timezone"):"GMT"));a=parseInt(getStreamUptimeSeconds($.channelName)/60),h=parseInt(a/60),g=parseInt(a%60),10>g&&(g="0"+g),e=h+":"+g,n=getCurLocalTimeString("'['dd-MM-yyyy']'"),$.inidb.set("highlights",e,n+" "+d.splice(0).join(" ")),$.say($.whisperPrefix(m)+$.lang.get("highlightcommand.highlight.success",e)),$.logEvent("highlightCommand.js",48,m+" added a highlight at "+e)}if(l.equalsIgnoreCase("gethighlights")||l.equalsIgnoreCase("showhighlights")){if(!$.inidb.FileExists("highlights"))return void $.say($.whisperPrefix(m)+$.lang.get("highlightcommand.gethighlights.no-highlights"));t="",s=$.inidb.GetKeyList("highlights","");for(var o=s.length-1;o>=0;o--)t=t+"[ "+s[o]+" > "+$.inidb.get("highlights",s[o])+" ] ";return void $.say($.whisperPrefix(m)+"Highlights: "+t)}return l.equalsIgnoreCase("clearhighlights")?($.inidb.RemoveFile("highlights"),$.inidb.ReloadFile("highlights"),$.say($.whisperPrefix(m)+$.lang.get("highlightcommand.clearhighlights.success")),void $.logEvent("dualstreamCommand.js",70,m+" cleared highlights")):void 0}),$.bind("initReady",function(){$.bot.isModuleEnabled("./commands/highlightCommand.js")&&($.registerChatCommand("./commands/highlightCommand.js","highlight",2),$.registerChatCommand("./commands/highlightCommand.js","gethighlights",2),$.registerChatCommand("./commands/highlightCommand.js","showhighlights",2),$.registerChatCommand("./commands/highlightCommand.js","clearhighlights",1))})}();
