!function(){function e(e,s){e=e.toLowerCase(),s=s.toLowerCase(),$.inidb.exists("pricecom",s)&&parseInt($.inidb.get("pricecom",s))>0&&($.isMod(e)||($.inidb.incr("points",e,$.inidb.get("pricecom",s)),$.inidb.SaveAll()))}function s(e,s,a,m,i){var r,n,o,e=e+"",t=s.getSender(),d=s.getArgs();if(-1!=e.indexOf("(touser)"))if(d.length<1)n=t;else{if(!$.userExists(d[0]))return $.whisperPrefix(t)+$.lang.get("customcommands.touser.offline",d[0]);n=d[0]}if(-1!=e.indexOf("(price)")&&(o=null==$.inidb.get("pricecom",a)?0:$.inidb.get("pricecom",a)),-1!=e.indexOf("(count)")&&$.inidb.incr("commandCount",a,1),m)for(r in m){var c=new RegExp("/"+m[r].replace(/([\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|])/g,"\\$&")+"/","ig");e=e.replace(c,i[r])}return e.match(/\(sender\)|\(touser\)|\(@sender\)|\(baresender\)|\(random\)|\(pointname\)|\(uptime\)|\(game\)|\(status\)|\(follows\)|\(count\)|\(price\)/)?e.replace("(sender)",$.username.resolve(s.getSender())).replace("(touser)",$.username.resolve(n)).replace("(@sender)","@"+$.username.resolve(s.getSender())).replace("(baresender)",s.getSender()).replace("(random)",$.username.resolve($.randElement($.users)[0])).replace("(pointname)",$.pointNameMultiple).replace("(uptime)",$.getStreamUptime($.channelName)).replace("(game)",$.getGame($.channelName)).replace("(status)",$.getStatus($.channelName)).replace("(follows)",$.getFollows($.channelName)).replace("(count)",$.inidb.get("commandCount",a)).replace("(price)",o):e}function a(e,s,a){return $.isAdmin(e)?!0:""==a?$.getCommandGroup(s)>=$.getUserGroupId(e):$.getSubcommandGroup(s,a)>=$.getUserGroupId(e)}function m(e){return parseInt($.inidb.exists("pricecom",e)?$.inidb.get("pricecom",e):0)}function i(){var e,s=$.inidb.GetKeyList("command","");for(e in s)$.commandExists(s[e])||$.registerChatCommand("./commands/customCommands.js",s[e],7)}function r(){var e,s,a=$.inidb.GetKeyList("aliases","");for(s in a)$.commandExists(a[s])||(e=$.inidb.get("aliases",a[s]),$.registerChatCommand("./commands/customCommands.js",a[s],$.getCommandGroup(e)))}$.bind("command",function(e){var a=e.getSender().toLowerCase(),m=($.username.resolve(a,e.getTags()),e.getCommand()),i=e.getArgs(),r=e.getArguments(),n=i[0],o=i[1];if(m.equalsIgnoreCase("addcom")){if(!$.isModv3(a,e.getTags()))return void $.say($.whisperPrefix(a)+$.modMsg);if(!n||!o)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.add.usage"));n=i[0].replace("!",""),r=r.substring(r.indexOf(i[0])+i[0].length()+1),$.inidb.set("command",n,r),$.registerChatCommand("./commands/customCommands.js",n),$.logEvent("./commands/customCommands.js",28,a+" added command !"+n+' with the message "'+r+'"'),$.say($.whisperPrefix(a)+$.lang.get("customcommands.add.success",n))}if(m.equalsIgnoreCase("editcom")){if(!$.isModv3(a,e.getTags()))return void $.say($.whisperPrefix(a)+$.modMsg);if(n=i[0].replace("!",""),!n||!o)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.edit.usage"));if(!$.commandExists(n))return void $.say($.whisperPrefix(a)+$.lang.get("cmd.404",n));r=r.substring(r.indexOf(i[0])+i[0].length()+1),$.inidb.set("command",n,r),$.registerChatCommand("./commands/customCommands.js",n),$.logEvent("./commands/customCommands.js",28,a+" edited the command !"+n+' with the message "'+r+'"'),$.say($.whisperPrefix(a)+$.lang.get("customcommands.edit.success",n))}if(m.equalsIgnoreCase("delcom")){if(!$.isModv3(a,e.getTags()))return void $.say($.whisperPrefix(a)+$.modMsg);if(!i[0])return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.usage"));if(n=i[0].replace("!",""),!n)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.usage"));if(!$.inidb.exists("command",n))return void $.say($.whisperPrefix(a)+$.lang.get("cmd.404",n));$.inidb.del("command",n),$.inidb.del("permcom",n),$.unregisterChatCommand("./commands/customCommands.js",n),$.logEvent("./commands/customCommands.js",28,a+" deleted the command !"+n),$.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.success",n))}if(m.equalsIgnoreCase("aliascom")){if(!$.isModv3(a,e.getTags()))return void $.say($.whisperPrefix(a)+$.modMsg);if(!n||!o)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.usage"));if(!$.commandExists(n))return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.error.target404"));if(n=i[0].replace("!",""),o=i[1].replace("!",""),$.inidb.exists("aliases",o))return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.error"));$.inidb.set("aliases",o,n),$.registerChatCommand("./commands/customCommands.js",o),$.logEvent("customCommands.js",59,a+' added alias "!'+o+'" for "!'+n+'"'),$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.success",n,o))}if(m.equalsIgnoreCase("delalias")){if(!$.isModv3(a,e.getTags()))return void $.say($.whisperPrefix(a)+$.modMsg);if(!n||!o)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.delete.usage"));if(!$.inidb.exists("alias",n))return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.delete.error.alias.404"));n=i[0].replace("!",""),$.unregisterChatCommand(n),$.inidb.del("aliases",n),$.logEvent("customCommands.js",56,a+" deleted alias !"+n),$.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.success",n))}if(m.equalsIgnoreCase("permcom")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);if(!n||!o)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.usage"));if(n=i[0].replace("!",""),2==i.length){var t=i[1];if(isNaN(parseInt(t))&&(t=$.getGroupIdByName(t)),!$.commandExists(n))return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.404",n));$.inidb.set("permcom",n,t),$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.success",n,$.getGroupNameById(t))),$.updateCommandGroup(n,t)}var d=i[1],t=i[2];if(isNaN(parseInt(t))&&(t=$.getGroupIdByName(t)),!$.subCommandExists(n,d))return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.404",n+" "+d));$.inidb.set("permcom",n+" "+d,t),$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.success",n+" "+d,$.getGroupNameById(t))),$.updateSubcommandGroup(n,d,t)}if(m.equalsIgnoreCase("pricecom")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);if(!n||!o)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.usage"));if(!$.commandExists(n))return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.error.404"));if(isNaN(parseInt(o))||parseInt(o)<0)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.error.invalid"));n=i[0].replace("!",""),$.inidb.set("pricecom",n,o),list=$.inidb.GetKeyList("aliases","");for(c in list)for(c in list)$.inidb.get("aliases",list[c]).equalsIgnoreCase(n)&&$.inidb.set("pricecom",list[c],o);$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.success",n,o,$.pointNameMultiple))}if(m.equalsIgnoreCase("listtags")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);$.say($.whisperPrefix(a)+"Command tags: (sender), (@sender), (baresender), (random), (uptime), (game), (status), (follows), (count), (touser), (price), (pointname)")}if(m.equalsIgnoreCase("commands")){var c,g=$.inidb.GetKeyList("command",""),u="";for(c in g)u+="!",u+=g[c],u+=", ";if(0!=u.length)return void $.say($.whisperPrefix(a)+$.lang.get("customcommands.cmds",u))}$.inidb.exists("command",m.toLowerCase())&&(o=$.inidb.get("command",m.toLowerCase()),$.say(s(o,e,m.toLowerCase())))}),$.bind("initReady",function(){$.bot.isModuleEnabled("./commands/customCommands.js")&&(i(),r(),$.registerChatCommand("./commands/customCommands.js","addcom",2),$.registerChatCommand("./commands/customCommands.js","pricecom",2),$.registerChatCommand("./commands/customCommands.js","aliascom",2),$.registerChatCommand("./commands/customCommands.js","delalias",2),$.registerChatCommand("./commands/customCommands.js","delcom",2),$.registerChatCommand("./commands/customCommands.js","editcom",2),$.registerChatCommand("./commands/customCommands.js","permcom",1),$.registerChatCommand("./commands/customCommands.js","listtags",2),$.registerChatCommand("./commands/customCommands.js","commands",7))}),$.returnCommandCost=e,$.replaceCommandTags=s,$.permCom=a,$.getCommandPrice=m}();
