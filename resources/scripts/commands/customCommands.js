(function(){function e(e,s){e=e.toLowerCase();s=s.toLowerCase();if($.inidb.exists("pricecom",s)&&parseInt($.inidb.get("pricecom",s))>0){if(!$.isMod(e)){$.inidb.incr("points",e,$.inidb.get("pricecom",s));$.inidb.SaveAll()}}}function s(e,s,a,m){var i;e=e+"";if(a){for(i in a){var r=new RegExp("/"+a[i].replace(/([\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|])/g,"\\$&")+"/","ig");e=e.replace(r,m[i])}}return e.replace("(sender)",$.resolveRank(s.getSender().toLowerCase())).replace("(baresender)",$.username.resolve(s.getSender().toLowerCase())).replace("(random)",$.username.resolve($.randElement($.users)[0])).replace("(pointname)",$.pointNameMultiple)}function a(e,s){if($.isAdmin(e)){return true}return $.getCommandGroup(s)>=$.getUserGroupId(e)}function m(e){return parseInt($.inidb.exists("pricecom",e)?$.inidb.get("pricecom",e):0)}function i(){var e=$.inidb.GetKeyList("command",""),s;for(s in e){if(!$.commandExists(e[s])){$.registerChatCommand("./commands/customCommands.js",e[s],$.inidb.exists("permcom",e[s])?parseInt($.inidb.get("permcom",e[s])):7)}}}function r(){var e=$.inidb.GetKeyList("aliases",""),s,a;for(a in e){if(!$.commandExists(e[a])){s=$.inidb.get("aliases",e[a]);$.registerChatCommand("./commands/customCommands.js",e[a],$.getCommandGroup(s))}}}$.bind("command",function(e){var a=e.getSender().toLowerCase(),m=$.username.resolve(a,e.getTags()),i=e.getCommand(),n=e.getArgs(),t=e.getArguments(),o=n[0],d=n[1];if(i.equalsIgnoreCase("addcom")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}if(!o||!d){$.say($.whisperPrefix(a)+$.lang.get("customcommands.add.usage"));return}o=n[0].replace("!","");t=t.substring(t.indexOf(n[0])+n[0].length()+1);$.inidb.set("command",o,t);$.registerChatCommand("./commands/customCommands.js",o);$.logEvent("./commands/customCommands.js",28,a+" added command !"+o+' with the message "'+t+'"');$.say($.whisperPrefix(a)+$.lang.get("customcommands.add.success",o))}if(i.equalsIgnoreCase("editcom")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}o=n[0].replace("!","");if(!o||!d){$.say($.whisperPrefix(a)+$.lang.get("customcommands.edit.usage"));return}else if(!$.commandExists(o)){$.say($.whisperPrefix(a)+$.lang.get("cmd.404",o));return}t=t.substring(t.indexOf(n[0])+n[0].length()+1);$.inidb.set("command",o,t);$.registerChatCommand("./commands/customCommands.js",o);$.logEvent("./commands/customCommands.js",28,a+" edited the command !"+o+' with the message "'+t+'"');$.say($.whisperPrefix(a)+$.lang.get("customcommands.edit.success",o))}if(i.equalsIgnoreCase("delcom")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}o=n[0].replace("!","");if(!o){$.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.usage"));return}else if(!$.inidb.exists("command",o)){$.say($.whisperPrefix(a)+$.lang.get("cmd.404",o));return}$.inidb.del("command",o);$.inidb.del("permcom",o);$.unregisterChatCommand("./commands/customCommands.js",o);$.logEvent("./commands/customCommands.js",28,a+" deleted the command !"+o);$.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.success",o))}if(i.equalsIgnoreCase("aliascom")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}if(!o||!d){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.usage"));return}else if(!$.commandExists(o)){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.error.target404"));return}o=n[0].replace("!","");d=n[1].replace("!","");if($.inidb.exists("aliases",d)){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.error"));return}$.inidb.set("aliases",d,o);$.registerChatCommand("./commands/customCommands.js",d);$.logEvent("customCommands.js",59,a+' added alias "!'+d+'" for "!'+o+'"');$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.success",o,d))}if(i.equalsIgnoreCase("delalias")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}if(!o||!d){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.delete.usage"));return}else if(!$.inidb.exists("alias",o)){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.delete.error.alias.404"));return}o=n[0].replace("!","");$.unregisterChatCommand(o);$.inidb.del("aliases",o);$.logEvent("customCommands.js",56,a+" deleted alias !"+o);$.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.success",o))}if(i.equalsIgnoreCase("permcom")){if(!$.isAdmin(a)){$.say($.whisperPrefix(a)+$.adminMsg);return}if(!o||!d){$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.usage"));return}o=n[0].replace("!","");var c=n[1];if(isNaN(parseInt(c))){c=$.getGroupIdByName(c)}$.inidb.set("permcom",o,c);$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.success",o,$.getGroupNameById(c)))}if(i.equalsIgnoreCase("pricecom")){if(!$.isAdmin(a)){$.say($.whisperPrefix(a)+$.adminMsg);return}if(!o||!d){$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.usage"));return}else if(!$.commandExists(o)){$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.error.404"));return}else if(isNaN(parseInt(d))||parseInt(d)<0){$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.error.invalid"));return}o=n[0].replace("!","");$.inidb.set("pricecom",o,d);list=$.inidb.GetKeyList("aliases","");for(l in list){for(l in list){if($.inidb.get("aliases",list[l]).equalsIgnoreCase(o)){$.inidb.set("pricecom",list[l],d)}}}$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.success",o,d,$.pointNameMultiple))}if(i.equalsIgnoreCase("commands")){var g=$.inidb.GetKeyList("command",""),u="",l;for(l in g){u+="!";u+=g[l];u+=", "}if(u.length!=0){$.say($.whisperPrefix(a)+$.lang.get("customcommands.cmds",u));return}}if($.inidb.exists("command",i.toLowerCase())){d=$.inidb.get("command",i.toLowerCase());$.say(s(d,e))}r()});$.bind("initReady",function(){if($.bot.isModuleEnabled("./commands/customCommands.js")){i();r();$.registerChatCommand("./commands/customCommands.js","addcom",2);$.registerChatCommand("./commands/customCommands.js","pricecom",2);$.registerChatCommand("./commands/customCommands.js","aliascom",2);$.registerChatCommand("./commands/customCommands.js","delalias",2);$.registerChatCommand("./commands/customCommands.js","delcom",2);$.registerChatCommand("./commands/customCommands.js","editcom",2);$.registerChatCommand("./commands/customCommands.js","permcom",1);$.registerChatCommand("./commands/customCommands.js","commands",7)}});$.returnCommandCost=e;$.replaceCommandTags=s;$.permCom=a;$.getCommandPrice=m})();
