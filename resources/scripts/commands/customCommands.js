(function(){function e(e,s){e=e.toLowerCase();s=s.toLowerCase();if($.inidb.exists("pricecom",s)&&parseInt($.inidb.get("pricecom",s))>0){if(!$.isMod(e)){$.inidb.incr("points",e,$.inidb.get("pricecom",s));$.inidb.SaveAll()}}}function s(e,s,a,m,i){var r;e=e+"",args=s.getArgs();if(e.indexOf("(count)")!=-1){$.inidb.incr("commandCount",a,1)}if(e.indexOf("(touser)")!=-1){if(args.length!=0){return e.replace("(touser)",$.username.resolve(args[0]))}else{return e.replace("(touser)",$.username.resolve(s.getSender()))}}if(m){for(r in m){var n=new RegExp("/"+m[r].replace(/([\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|])/g,"\\$&")+"/","ig");e=e.replace(n,i[r])}}return e.replace("(sender)",$.username.resolve(s.getSender())).replace("(@sender)","@"+$.username.resolve(s.getSender())).replace("(baresender)",s.getSender()).replace("(random)",$.username.resolve($.randElement($.users)[0])).replace("(pointname)",$.pointNameMultiple).replace("(uptime)",$.getStreamUptime($.channelName)).replace("(game)",$.getGame($.channelName)).replace("(status)",$.getStatus($.channelName)).replace("(follows)",$.getFollows($.channelName)).replace("(count)",$.inidb.get("commandCount",a))}function a(e,s){if($.isAdmin(e)){return true}return $.getCommandGroup(s)>=$.getUserGroupId(e)}function m(e){return parseInt($.inidb.exists("pricecom",e)?$.inidb.get("pricecom",e):0)}function i(){var e=$.inidb.GetKeyList("command",""),s;for(s in e){if(!$.commandExists(e[s])){$.registerChatCommand("./commands/customCommands.js",e[s],$.inidb.exists("permcom",e[s])?parseInt($.inidb.get("permcom",e[s])):7)}}}function r(){var e=$.inidb.GetKeyList("aliases",""),s,a;for(a in e){if(!$.commandExists(e[a])){s=$.inidb.get("aliases",e[a]);$.registerChatCommand("./commands/customCommands.js",e[a],$.getCommandGroup(s))}}}$.bind("command",function(e){var a=e.getSender().toLowerCase(),m=$.username.resolve(a,e.getTags()),i=e.getCommand(),r=e.getArgs(),n=e.getArguments(),t=r[0],o=r[1];if(i.equalsIgnoreCase("addcom")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}if(!t||!o){$.say($.whisperPrefix(a)+$.lang.get("customcommands.add.usage"));return}t=r[0].replace("!","");n=n.substring(n.indexOf(r[0])+r[0].length()+1);$.inidb.set("command",t,n);$.registerChatCommand("./commands/customCommands.js",t);$.logEvent("./commands/customCommands.js",28,a+" added command !"+t+' with the message "'+n+'"');$.say($.whisperPrefix(a)+$.lang.get("customcommands.add.success",t))}if(i.equalsIgnoreCase("editcom")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}t=r[0].replace("!","");if(!t||!o){$.say($.whisperPrefix(a)+$.lang.get("customcommands.edit.usage"));return}else if(!$.commandExists(t)){$.say($.whisperPrefix(a)+$.lang.get("cmd.404",t));return}n=n.substring(n.indexOf(r[0])+r[0].length()+1);$.inidb.set("command",t,n);$.registerChatCommand("./commands/customCommands.js",t);$.logEvent("./commands/customCommands.js",28,a+" edited the command !"+t+' with the message "'+n+'"');$.say($.whisperPrefix(a)+$.lang.get("customcommands.edit.success",t))}if(i.equalsIgnoreCase("delcom")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}t=r[0].replace("!","");if(!t){$.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.usage"));return}else if(!$.inidb.exists("command",t)){$.say($.whisperPrefix(a)+$.lang.get("cmd.404",t));return}$.inidb.del("command",t);$.inidb.del("permcom",t);$.unregisterChatCommand("./commands/customCommands.js",t);$.logEvent("./commands/customCommands.js",28,a+" deleted the command !"+t);$.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.success",t))}if(i.equalsIgnoreCase("aliascom")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}if(!t||!o){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.usage"));return}else if(!$.commandExists(t)){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.error.target404"));return}t=r[0].replace("!","");o=r[1].replace("!","");if($.inidb.exists("aliases",o)){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.error"));return}$.inidb.set("aliases",o,t);$.registerChatCommand("./commands/customCommands.js",o);$.logEvent("customCommands.js",59,a+' added alias "!'+o+'" for "!'+t+'"');$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.success",t,o))}if(i.equalsIgnoreCase("delalias")){if(!$.isModv3(a,e.getTags())){$.say($.whisperPrefix(a)+$.modMsg);return}if(!t||!o){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.delete.usage"));return}else if(!$.inidb.exists("alias",t)){$.say($.whisperPrefix(a)+$.lang.get("customcommands.alias.delete.error.alias.404"));return}t=r[0].replace("!","");$.unregisterChatCommand(t);$.inidb.del("aliases",t);$.logEvent("customCommands.js",56,a+" deleted alias !"+t);$.say($.whisperPrefix(a)+$.lang.get("customcommands.delete.success",t))}if(i.equalsIgnoreCase("permcom")){if(!$.isAdmin(a)){$.say($.whisperPrefix(a)+$.adminMsg);return}if(!t||!o){$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.usage"));return}t=r[0].replace("!","");var d=r[1];if(isNaN(parseInt(d))){d=$.getGroupIdByName(d)}$.inidb.set("permcom",t,d);$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.perm.success",t,$.getGroupNameById(d)))}if(i.equalsIgnoreCase("pricecom")){if(!$.isAdmin(a)){$.say($.whisperPrefix(a)+$.adminMsg);return}if(!t||!o){$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.usage"));return}else if(!$.commandExists(t)){$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.error.404"));return}else if(isNaN(parseInt(o))||parseInt(o)<0){$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.error.invalid"));return}t=r[0].replace("!","");$.inidb.set("pricecom",t,o);list=$.inidb.GetKeyList("aliases","");for(l in list){for(l in list){if($.inidb.get("aliases",list[l]).equalsIgnoreCase(t)){$.inidb.set("pricecom",list[l],o)}}}$.say($.whisperPrefix(a)+$.lang.get("customcommands.set.price.success",t,o,$.pointNameMultiple))}if(i.equalsIgnoreCase("listtags")){if(!$.isAdmin(a)){$.say($.whisperPrefix(a)+$.adminMsg);return}$.say($.whisperPrefix(a)+"Command tags: (sender), (@sender), (baresender), (random), (pointname), (uptime), (game), (status), (follows), (count), (touser)")}if(i.equalsIgnoreCase("commands")){var c=$.inidb.GetKeyList("command",""),g="",l;for(l in c){g+="!";g+=c[l];g+=", "}if(g.length!=0){$.say($.whisperPrefix(a)+$.lang.get("customcommands.cmds",g));return}}if($.inidb.exists("command",i.toLowerCase())){o=$.inidb.get("command",i.toLowerCase());$.say(s(o,e,i.toLowerCase()))}});$.bind("initReady",function(){if($.bot.isModuleEnabled("./commands/customCommands.js")){i();r();$.registerChatCommand("./commands/customCommands.js","addcom",2);$.registerChatCommand("./commands/customCommands.js","pricecom",2);$.registerChatCommand("./commands/customCommands.js","aliascom",2);$.registerChatCommand("./commands/customCommands.js","delalias",2);$.registerChatCommand("./commands/customCommands.js","delcom",2);$.registerChatCommand("./commands/customCommands.js","editcom",2);$.registerChatCommand("./commands/customCommands.js","permcom",1);$.registerChatCommand("./commands/customCommands.js","listtags",2);$.registerChatCommand("./commands/customCommands.js","commands",7)}});$.returnCommandCost=e;$.replaceCommandTags=s;$.permCom=a;$.getCommandPrice=m})();
