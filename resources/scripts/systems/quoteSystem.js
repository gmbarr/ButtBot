!function(){function e(e,t){var s=$.inidb.GetKeyList("quotes","").length;return $.inidb.set("quotes",s,JSON.stringify([e,t,$.systemTime()])),s}function t(e){var t,s,i=[];if($.inidb.exists("quotes",e)){$.inidb.del("quotes",e),t=$.inidb.GetKeyList("quotes","");for(s in t)i.push($.inidb.get("quotes",t[s])),$.inidb.del("quotes",t[s]);for(s in i)$.inidb.set("quotes",s,i[s]);return i.length?i.length:0}return-1}function s(e){return(!e||isNaN(e))&&(e=$.rand($.inidb.GetKeyList("quotes","").length)),$.inidb.exists("quotes",e)?JSON.parse($.inidb.get("quotes",e)):[]}$.bind("command",function(i){var n,o=i.getSender(),u=i.getCommand(),a=i.getArgs();if(u.equalsIgnoreCase("addquote")){if(a.length<2)return void $.say($.whisperPrefix(o)+$.lang.get("quotesystem.add.usage"));var r=(a[0]+"").toLowerCase();n=a.splice(1).join(" "),$.say($.lang.get("quotesystem.add.success",r,e(r,n)))}if(u.equalsIgnoreCase("delquote")){if(!a[0]||isNaN(a[0]))return void $.say($.whisperPrefix(o)+$.lang.get("quotesystem.del.usage"));var d;(d=t(a[0]))>=0?$.say($.whisperPrefix(o)+$.lang.get("quotesystem.del.success",a[0],d)):$.say($.whisperPrefix(o)+$.lang.get("quotesystem.del.404",a[0]))}u.equalsIgnoreCase("quote")&&(n=s(a[0]),n.length>0?$.say($.lang.get("quotesystem.get.success",n[1],$.resolveRank(n[0]),$.dateToString(new Date(parseInt(n[2]))))):$.say($.whisperPrefix(o)+$.lang.get("quotesystem.get.404","undefined"!=typeof a[0]?a[0]:"")))}),$.bind("initReady",function(){$.bot.isModuleEnabled("./systems/quoteSystem.js")&&($.registerChatCommand("./systems/quoteSystem.js","addquote",2),$.registerChatCommand("./systems/quoteSystem.js","delquote",2),$.registerChatCommand("./systems/quoteSystem.js","quote"))})}();
