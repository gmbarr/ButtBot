!function(){var e=$.inidb.exists("greeting","autoGreetEnabled")?$.getIniDbBoolean("greeting","autoGreetEnabled"):!1,i=$.inidb.exists("greeting","defaultJoin")?$.inidb.get("greeting","defaultJoin"):"",s=216e5;$.bind("ircChannelJoin",function(t){if($.isOnline($.channelName)){var n=t.getUser().toLowerCase(),g=$.resolveRank(n),r=$.inidb.exists("greeting",n)?$.inidb.get("greeting",n):"",a=$.inidb.exists("greetingCoolDown",n)?parseInt($.inidb.get("greetingCoolDown",n)):0,o=$.systemTime();r&&o>a+s?($.say(r),$.inidb.set("greetingCoolDown",n,o)):e&&$.say(i.replace("(name)",g))}}),$.bind("command",function(i){var s,t=i.getSender().toLowerCase(),n=i.getCommand(),g=i.getArgs(),r=g[0];if(n.equalsIgnoreCase("greeting")){if(!r)return void($.isAdmin(t)?$.say($.whisperPrefix(t)+$.lang.get("greetingsystem.generalusage.admin")):$.say($.whisperPrefix(t)+$.lang.get("greetingsystem.generalusage.other")));if(r.equalsIgnoreCase("toggledefault")){if(!$.isModv3(t,i.getTags()))return void $.say($.whisperPrefix(t)+$.modMsg);e=!e,$.setIniDbBoolean("greeting","autoGreetEnabled",e),e?$.say($.whisperPrefix(t)+$.lang.get("greetingsystem.set.autogreet.enabled",$.username.resolve($.botName))):$.say($.whisperPrefix(t)+$.lang.get("greetingsystem.set.autogreet.disabled",$.username.resolve($.botName)))}if(r.equalsIgnoreCase("setdefault")){if(s=g.splice(1,g.length-1).join(" "),!$.isModv3(t,i.getTags()))return void $.say($.whisperPrefix(t)+$.modMsg);if(!s)return void $.say($.whisperPrefix(t)+$.lang.get("greetingsystem.set.autogreet.usage"));if(s.indexOf("(name)")<0)return void $.say($.whisperPrefix(t)+$.lang.get("greetingsystem.set.autogreet.noname"));$.inidb.set("greeting","defaultJoin",s),$.say($.whisperPrefix(t)+$.lang.get("greetingsystem.set.autogreet.success",s,e?$.lang.get("common.enabled"):$.lang.get("common.disabled")))}if(r.equalsIgnoreCase("enable")){if(s=g.splice(1,g.length-1).join(" "),!s)return void $.say($.whisperPrefix(t)+$.lang.get("greetingsystem.generalusage.other"));$.inidb.set("greeting",t,s),$.say($.whisperPrefix(t)+$.lang.get("greetingsystem.set.personal.success",s))}r.equalsIgnoreCase("disable")&&$.inidb.exists("greeting",t)&&($.inidb.del("greeting",t),$.say($.whisperPrefix(t)+$.lang.get("greetingsystem.remove.personal.success")))}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./systems/greetingSystem.js")&&$.registerChatCommand("./systems/greetingSystem.js","greeting",6)})}();
