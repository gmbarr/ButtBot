!function(){var e=$.inidb.exists("greeting","autoGreetEnabled")?$.getIniDbBoolean("greeting","autoGreetEnabled"):!1,t=$.inidb.exists("greeting","defaultJoin")?$.inidb.get("greeting","defaultJoin"):"",n=parseInt($.inidb.exists("greeting","cooldown")?$.inidb.get("greeting","cooldown"):216e5);$.bind("ircChannelJoin",function(i){if($.isOnline($.channelName)){var g=i.getUser().toLowerCase(),s=$.resolveRank(g),r=$.inidb.exists("greeting",g)?$.inidb.get("greeting",g):"",a=$.inidb.exists("greetingCoolDown",g)?parseInt($.inidb.get("greetingCoolDown",g)):0,o=$.systemTime();o>a+n&&(r?($.say(r),$.inidb.set("greetingCoolDown",g,o)):e&&($.say(t.replace("(name)",s)),$.inidb.set("greetingCoolDown",g,o)))}}),$.bind("command",function(t){var i,g,s=t.getSender().toLowerCase(),r=t.getCommand(),a=t.getArgs(),o=a[0];if(r.equalsIgnoreCase("greeting")){if(!o)return void($.isAdmin(s)?$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.generalusage.admin")):$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.generalusage.other")));if(o.equalsIgnoreCase("cooldown"))return a[1]?(i=parseInt(a[1]),isNaN(i)?void $.say($.whisperPrefix(s)+$.lang.get("greetingsystem.cooldown.usage")):(n=6e5*i,$.inidb.set("greeting","cooldown",n),void $.say($.whisperPrefix(s)+$.lang.get("greetingsystem.cooldown.success",i,(i/60).toFixed(2))))):void $.say($.whisperPrefix(s)+$.lang.get("greetingsystem.cooldown.usage"));if(o.equalsIgnoreCase("toggledefault")&&(e=!e,$.setIniDbBoolean("greeting","autoGreetEnabled",e),e?$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.enabled",$.username.resolve($.botName))):$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.disabled",$.username.resolve($.botName)))),o.equalsIgnoreCase("setdefault")){if(g=a.splice(1,a.length-1).join(" "),!g)return void $.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.usage"));if(g.indexOf("(name)")<0)return void $.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.noname"));$.inidb.set("greeting","defaultJoin",g),$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.autogreet.success",g,e?$.lang.get("common.enabled"):$.lang.get("common.disabled")))}if(o.equalsIgnoreCase("enable")){if(g=a.splice(1,a.length-1).join(" "),!g)return void $.say($.whisperPrefix(s)+$.lang.get("greetingsystem.generalusage.other"));$.inidb.set("greeting",s,g),$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.set.personal.success",g))}o.equalsIgnoreCase("disable")&&$.inidb.exists("greeting",s)&&($.inidb.del("greeting",s),$.say($.whisperPrefix(s)+$.lang.get("greetingsystem.remove.personal.success")))}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./systems/greetingSystem.js")&&($.registerChatCommand("./systems/greetingSystem.js","greeting",6),$.registerChatSubcommand("greeting","cooldown",1),$.registerChatSubcommand("greeting","toggledefault",2),$.registerChatSubcommand("greeting","setdefault",2),$.registerChatSubcommand("greeting","enable",6),$.registerChatSubcommand("greeting","disable",6))})}();
