!function(){function e(){t=$.getIniDbBoolean("greeting","autoGreetEnabled"),n=$.getIniDbString("greeting","defaultJoin"),g=$.getIniDbNumber("greeting","cooldown")}var t=$.getSetIniDbBoolean("greeting","autoGreetEnabled",!1),n=$.getSetIniDbString("greeting","defaultJoin",""),g=$.getSetIniDbNumber("greeting","cooldown",216e5);$.bind("ircChannelJoin",function(e){if($.isOnline($.channelName)){var i=e.getUser().toLowerCase(),s=$.resolveRank(i),r=$.getIniDbString("greeting",i,""),a=$.getIniDbNumber("greetingCoolDown",i,0),o=$.systemTime();o>a+g&&(r?($.say(r),$.inidb.set("greetingCoolDown",i,o)):t&&($.say(n.replace("(name)",s)),$.inidb.set("greetingCoolDown",i,o)))}}),$.bind("command",function(n){var i,s,r=n.getSender().toLowerCase(),a=n.getCommand(),o=n.getArgs(),l=o[0];if(a.equalsIgnoreCase("greetingspanelupdate")&&e(),a.equalsIgnoreCase("greeting")){if(!l)return void($.isAdmin(r)?$.say($.whisperPrefix(r)+$.lang.get("greetingsystem.generalusage.admin")):$.say($.whisperPrefix(r)+$.lang.get("greetingsystem.generalusage.other")));if(l.equalsIgnoreCase("cooldown"))return o[1]?(i=parseInt(o[1]),isNaN(i)?void $.say($.whisperPrefix(r)+$.lang.get("greetingsystem.cooldown.usage")):(g=6e5*i,$.inidb.set("greeting","cooldown",g),void $.say($.whisperPrefix(r)+$.lang.get("greetingsystem.cooldown.success",i,(i/60).toFixed(2))))):void $.say($.whisperPrefix(r)+$.lang.get("greetingsystem.cooldown.usage"));if(l.equalsIgnoreCase("toggledefault")&&(t=!t,$.setIniDbBoolean("greeting","autoGreetEnabled",t),t?$.say($.whisperPrefix(r)+$.lang.get("greetingsystem.set.autogreet.enabled",$.username.resolve($.botName))):$.say($.whisperPrefix(r)+$.lang.get("greetingsystem.set.autogreet.disabled",$.username.resolve($.botName)))),l.equalsIgnoreCase("setdefault")){if(s=o.splice(1,o.length-1).join(" "),!s)return void $.say($.whisperPrefix(r)+$.lang.get("greetingsystem.set.autogreet.usage"));if(s.indexOf("(name)")<0)return void $.say($.whisperPrefix(r)+$.lang.get("greetingsystem.set.autogreet.noname"));$.inidb.set("greeting","defaultJoin",s),$.say($.whisperPrefix(r)+$.lang.get("greetingsystem.set.autogreet.success",s,t?$.lang.get("common.enabled"):$.lang.get("common.disabled")))}if(l.equalsIgnoreCase("enable")){if(s=o.splice(1,o.length-1).join(" "),!s)return void $.say($.whisperPrefix(r)+$.lang.get("greetingsystem.generalusage.other"));$.inidb.set("greeting",r,s),$.say($.whisperPrefix(r)+$.lang.get("greetingsystem.set.personal.success",s))}l.equalsIgnoreCase("disable")&&$.inidb.exists("greeting",r)&&($.inidb.del("greeting",r),$.say($.whisperPrefix(r)+$.lang.get("greetingsystem.remove.personal.success")))}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./systems/greetingSystem.js")&&($.registerChatCommand("./systems/greetingSystem.js","greetingspanelupdate",1),$.registerChatCommand("./systems/greetingSystem.js","greeting",6),$.registerChatSubcommand("greeting","cooldown",1),$.registerChatSubcommand("greeting","toggledefault",2),$.registerChatSubcommand("greeting","setdefault",2),$.registerChatSubcommand("greeting","enable",6),$.registerChatSubcommand("greeting","disable",6))})}();
