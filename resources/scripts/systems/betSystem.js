!function(){function e(e,t){{var i,s,r=e.getSender();e.getArgs()}if(n)return void $.say($.whisperPrefix(r)+$.lang.get("betsystem.err.bet.opened"));if(t.length<2)return void $.say($.whisperPrefix(r)+$.lang.get("betsystem.err.options"));for(s=0;s<t.length;s++)if(a.push(t[s].toLowerCase().trim()),!isNaN(t[s]))return $.say($.whisperPrefix(r)+$.lang.get("betsystem.err.open")),void(a=[]);i=a.join(" vs "),n=!0,$.say($.lang.get("betsystem.opened",i,$.pointNameMultiple))}function t(e,t,i){var r,m,d=(t.getArgs(),i.toLowerCase()),p=0,u=0,b="",f=0,y=0;if(!n)return void $.say($.whisperPrefix(e)+$.lang.get("betsystem.err.bet.closed"));if(!d)return void $.say($.whisperPrefix(e)+$.lang.get("betsystem.err.win.option"));if(!$.list.contains(a,d))return void $.say($.whisperPrefix(e)+$.lang.get("betsystem.err.option.404"));n=!1;for(m in g)r=g[m],r.option.equalsIgnoreCase(d)&&(f=r.amount);for(m in g)y++,r=g[m],r.option.equalsIgnoreCase(d)&&(u=o/f,u>0&&(b.length>0&&(b+=", "),b=m));if(s>y){for(m in g)r=g[m],$.inidb.incr("points",m,r.amount);return void $.say($.lang.get("betsystem.not.enough.ppl"))}if(0==f)return void $.say($.lang.get("betsystem.closed.404"));if(0>=o){for(m in g)r=g[m],$.inidb.incr("points",m,r.amount);return void $.say($.lang.get("betsystem.err.points.refunded"))}for(m in g)r=g[m],r.option.equalsIgnoreCase(d)&&(p=r.amount/f,$.inidb.incr("points",m,o*p));$.say($.lang.get("betsystem.closed",d,$.getPointsString(o*p))),o=0,f=0,b=""}var s=$.inidb.exists("betSettings","betMinimum")?parseInt($.inidb.get("betSettings","betMinimum")):0,r=$.inidb.exists("betSettings","betMaximum")?parseInt($.inidb.get("betSettings","betMaximum")):1e3,n=!1,o=0,a=[],g=[];$.bind("command",function(m){var d=m.getSender(),p=m.getCommand(),u=(m.getArguments().trim(),m.getArgs()),b=u[0],f=u[1],y=u.slice(1);if(p.equalsIgnoreCase("bet")){if(!b)return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.command.usage"));if(b.equalsIgnoreCase("open"))return $.isModv3(d,m.getTags())?void e(m,y):void $.say($.whisperPrefix(d)+$.modMsg);if(b.equalsIgnoreCase("close"))return $.isModv3(d,m.getTags())?void t(d,m,f):void $.say($.whisperPrefix(d)+$.modMsg);if(b.equalsIgnoreCase("setminimum"))return $.isModv3(d,m.getTags())?f?(s=parseInt(f),$.inidb.set("betSettings","betMinimum",s),void $.say($.whisperPrefix(d)+$.lang.get("betsystem.set.min",s,$.pointNameMultiple))):void $.say($.whisperPrefix(d)+$.lang.get("betsystem.set.min.usage")):void $.say($.whisperPrefix(d)+$.modMsg);if(b.equalsIgnoreCase("setmaximum"))return $.isModv3(d,m.getTags())?f?(r=parseInt(f),$.inidb.set("betSettings","betMinimum",r),void $.say($.whisperPrefix(d)+$.lang.get("betsystem.set.max",r,$.pointNameMultiple))):void $.say($.whisperPrefix(d)+$.lang.get("betsystem.set.max.usage")):void $.say($.whisperPrefix(d)+$.modMsg);if(!n)return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.err.bet.closed"));var l,v;if(!b||!f)return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.err.option.404"));if(isNaN(b)&&isNaN(f))return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.err.option.404"));if(isNaN(b)&&!isNaN(f)&&(l=parseInt(f),v=b),!isNaN(b)&&isNaN(f)&&(l=parseInt(b),v=f),!$.list.contains(a,v.toLowerCase()))return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.err.option.404"));if(1>l)return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.bet.err.neg",$.pointNameMultiple));if(s>l)return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.bet.err.less",$.getPointString(s)));if(l>r)return $.say($.whisperPrefix(d)+"You can not bet more then "+$.getPointString(r)),void $.say($.whisperPrefix(d)+$.lang.get("betsystem.bet.err.more",$.getPointString(r)));if(parseInt($.getUserPoints(d.toLowerCase()))<l)return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.err.points",$.pointNameMultiple));for(i in g)if(d.equalsIgnoreCase(i))return void $.say($.whisperPrefix(d)+$.lang.get("betsystem.err.voted"));$.inidb.decr("points",d,l),0==o?o=l:o+=l,g[d]={amount:l,option:v},$.say($.lang.get("betsystem.bet.updated",d,$.getPointsString(l),v,$.getPointsString(o)))}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./systems/betSystem.js")&&$.registerChatCommand("./systems/betSystem.js","bet",7)})}();
