!function(){var e=$.inidb.exists("settings","hostReward")?$.inidb.get("settings","hostReward"):200,s=$.inidb.exists("settings","hostMessage")?$.inidb.get("settings","hostMessage"):$.lang.get("hosthandler.host.message"),t=216e5,n={},a=!1;$.bind("twitchHostsInitialized",function(){$.bot.isModuleEnabled("./handlers/hostHandler.js")&&($.consoleLn(">> Enabling hosts announcements"),$.logEvent("hostHandler.js",23,"Host announcements enabled"),a=!0)}),$.bind("twitchHosted",function(o){if($.bot.isModuleEnabled("./handlers/hostHandler.js")){var i=$.username.resolve(o.getHoster()),r=$.systemTime(),h=s;if(a){if($.writeToFile(i,"./addons/hostHandler/latestHost.txt",!1),n[i]){if(n[i].hostTime>r)return;n[i].hostTime=r+t}else n[i]={hostTime:r+t};h=h.replace("(name)",i),h=h.replace("(reward)",e.toString()),$.say(h)}}}),$.bind("twitchUnhosted",function(e){if($.bot.isModuleEnabled("./handlers/hostHandler.js")){var s=e.getHoster();delete n[s]}}),$.bind("command",function(e){var t,a=e.getSender().toLowerCase(),o=e.getCommand(),i=e.getArgs(),r=parseInt(i[0]),h=[];if(o.equalsIgnoreCase("hostreward")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);if(isNaN(r))return void $.say($.whisperPrefix(a)+$.lang.get("hosthandler.set.hostreward.usage",$.pointNameMultiple));$.inidb.set("settings","hostReward",r),$.say($.whisperPrefix(a)+$.lang.get("hosthandler.set.hostreward.success",$.getPointsString(r))),$.logEvent("hostHandler.js",100,a+" changed the host reward to "+r)}if(o.equalsIgnoreCase("hostmessage")){if(!i||0==i.length)return void $.say($.whisperPrefix(a)+$.lang.get("hosthandler.set.hostmessage.usage"));s=e.getArguments(),$.inidb.set("settings","hostMessage",s),$.say($.whisperPrefix(a)+$.lang.get("hosthandler.set.hostmessage.success")),$.logEvent("hostHandler.js",115,a+" changed the host message to "+s)}if(o.equalsIgnoreCase("unhost")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);$.say(".unhost")}if(o.equalsIgnoreCase("host")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);$.say(".host "+i[0]),$.logEvent("hostHandler.js",140,a+" hosted channel "+i[1])}if(o.equalsIgnoreCase("hostcount")){for(t in n)h.push(t);if(0==h.length)return void $.say($.lang.get("hosthandler.hostcount.404"));$.say($.lang.get("hosthandler.hostcount",h.length))}if(o.equalsIgnoreCase("hostlist")){for(t in n)h.push(t);if(0==h.length)return void $.say($.lang.get("hosthandler.hostlist.404"));$.say($.lang.get("hosthandler.hostlist",h.join(", ")))}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./handlers/hostHandler.js")&&($.registerChatCommand("./handlers/hostHandler.js","hostmessage",1),$.registerChatCommand("./handlers/hostHandler.js","hostreward",1),$.registerChatCommand("./handlers/hostHandler.js","unhost",1),$.registerChatCommand("./handlers/hostHandler.js","host",1),$.registerChatCommand("./handlers/hostHandler.js","hostcount"),$.registerChatCommand("./handlers/hostHandler.js","hostlist"))})}();
