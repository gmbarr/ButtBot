!function(){var s=$.inidb.exists("settings","hostReward")?$.inidb.get("settings","hostReward"):200,e=$.inidb.exists("settings","hostMessage")?$.inidb.get("settings","hostMessage"):$.lang.get("hosthandler.host.message"),t=216e5,n={},a=!1;$.bind("twitchHostsInitialized",function(){$.bot.isModuleEnabled("./handlers/hostHandler.js")&&($.consoleLn(">> Enabling hosts announcements"),a=!0)}),$.bind("twitchHosted",function(i){if($.bot.isModuleEnabled("./handlers/hostHandler.js")){var r=$.username.resolve(i.getHoster()),o=$.systemTime(),h=e;if(a){if($.writeToFile(r,"./addons/hostHandler/latestHost.txt",!1),n[r]){if(n[r].hostTime>o)return;n[r].hostTime=o+t}else n[r]={hostTime:o+t};h=h.replace("(name)",r),h=h.replace("(reward)",s.toString()),$.say(h)}}}),$.bind("twitchUnhosted",function(s){if($.bot.isModuleEnabled("./handlers/hostHandler.js")){var e=s.getHoster();delete n[e]}}),$.bind("command",function(s){var t,a=s.getSender().toLowerCase(),i=s.getCommand(),r=s.getArgs(),o=parseInt(r[0]),h=[];if(i.equalsIgnoreCase("hostreward")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);if(isNaN(o))return void $.say($.whisperPrefix(a)+$.lang.get("hosthandler.set.hostreward.usage",$.pointNameMultiple));$.inidb.set("settings","hostReward",o),$.say($.whisperPrefix(a)+$.lang.get("hosthandler.set.hostreward.success",$.getPointsString(o)))}if(i.equalsIgnoreCase("hostmessage")){if(!r||0==r.length)return void $.say($.whisperPrefix(a)+$.lang.get("hosthandler.set.hostmessage.usage"));e=s.getArguments(),$.inidb.set("settings","hostMessage",e),$.say($.whisperPrefix(a)+$.lang.get("hosthandler.set.hostmessage.success"))}if(i.equalsIgnoreCase("unhost")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);$.say(".unhost")}if(i.equalsIgnoreCase("host")){if(!$.isAdmin(a))return void $.say($.whisperPrefix(a)+$.adminMsg);$.say(".host "+r[0])}if(i.equalsIgnoreCase("hostcount")&&$.say($.lang.get("hosthandler.newhost",n.length)),i.equalsIgnoreCase("hostlist")){for(t in n)h.push(t);if(0==h.length)return void $.say($.lang.get("hosthandler.hostlist.404"));$.say($.lang.get("hosthandler.hostlist",h.join(", ")))}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./handlers/hostHandler.js")&&($.registerChatCommand("./handlers/hostHandler.js","hostmessage",1),$.registerChatCommand("./handlers/hostHandler.js","hostreward",1),$.registerChatCommand("./handlers/hostHandler.js","unhost",1),$.registerChatCommand("./handlers/hostHandler.js","host",1),$.registerChatCommand("./handlers/hostHandler.js","hostcount"),$.registerChatCommand("./handlers/hostHandler.js","hostlist"))})}();
