!function(){function e(){$.systemTime()-l>3e5?(3==o?$.say($.lang.get("followhandler.followtrain.triple")):4==o?$.say($.lang.get("followhandler.followtrain.quad")):5==o?$.say($.lang.get("followhandler.followtrain.penta")):20==o?$.say($.lang.get("followhandler.followtrain.mega",o)):30==o?$.say($.lang.get("followhandler.followtrain.ultra",o)):50==o&&$.say($.lang.get("followhandler.followtrain.unbelievable",o)),++o):o=1,l=$.systemTime()}var l=0,o=0,s=!1,n=$.inidb.exists("settings","followReward")?parseInt($.inidb.get("settings","followReward")):100,a=$.inidb.exists("settings","followMessage")?$.inidb.get("settings","followMessage"):$.lang.get("followhandler.follow.message"),t=$.inidb.exists("settings","followMessageNoReward")?$.inidb.get("settings","followMessageNoReward"):$.lang.get("followhandler.follow.message.noreward"),r=$.inidb.exists("settings","followToggle")?$.inidb.get("settings","followToggle"):!1;$.bind("twitchFollowsInitialized",function(){$.bot.isModuleEnabled("./handlers/followHandler.js")&&($.consoleLn(">> Enabling follower announcements"),$.logEvent("followHandler.js",56,"Follow announcements enabled"),s=!0)}),$.bind("twitchFollow",function(l){if($.bot.isModuleEnabled("./handlers/followHandler.js")&&r){var o=l.getFollower().toLowerCase();$.inidb.exists("followed",o)||($.bot.isModuleEnabled("./commands/lastseenCommand.js")&&$.inidb.set("lastseen",o,$.systemTime()),n>0&&$.inidb.incr("points",o,n),s&&(n>0&&$.bot.isModuleEnabled("./systems/pointSystem.js")?(followmsg=a.replace("(name)",$.username.resolve(o)),followmsg=followmsg.replace("(reward)",$.getPointsString(n))):followmsg=t.replace("(name)",$.username.resolve(o)),$.say(followmsg)),$.setIniDbBoolean("followed",o,!0),$.writeToFile($.username.resolve(o),"./addons/followHandler/latestFollower.txt",!1),e())}}),$.bind("twitchUnfollow",function(e){if($.bot.isModuleEnabled("./handlers/followHandler.js")){var l=e.getFollows().toLowerCase(),o=$.getIniDbBoolean("followed",l);o&&$.setIniDbBoolean("followed",l,!1)}}),$.bind("command",function(e){var l,o,s,i,w=e.getSender().toLowerCase(),g=e.getCommand(),d=e.getArgs(),f=e.getArguments(),h=d[0];if(g.equalsIgnoreCase("followreward")){if(h=parseInt(h),!d[0]||isNaN(h))return void $.say($.whisperPrefix(w)+$.lang.get("followhandler.set.followreward.usage",$.pointNameMultiple,n));n=h,$.inidb.set("settings","followReward",n),$.say($.whisperPrefix(w)+$.lang.get("followhandler.set.followreward.success",$.getPointsString(n))),$.logEvent("followHandler.js",141,w+" set the follow reward to "+n)}if(g.equalsIgnoreCase("followmessage")){if(!h||0>=h)return void $.say($.whisperPrefix(w)+$.lang.get("followhandler.set.followmessage.usage"));a=f,$.inidb.set("settings","followMessage",a),$.say($.whisperPrefix(w)+$.lang.get("followhandler.set.followmessage.success")),$.logEvent("followHandler.js",156,w+" set the follow message to "+a)}if(g.equalsIgnoreCase("followmessagenoreward")){if(!h||0>=h)return void $.say($.whisperPrefix(w)+$.lang.get("followhandler.set.followmessagenoreward.usage"));t=f,$.inidb.set("settings","followMessageNoReward",t),$.say($.whisperPrefix(w)+$.lang.get("followhandler.set.followmessagenoreward.success")),$.logEvent("followHandler.js",171,w+" set the follow message no reward to "+t)}if(g.equalsIgnoreCase("followtoggle")&&(r?(r=!1,$.inidb.set("settings","followToggle",r),$.say($.whisperPrefix(w)+$.lang.get("followhandler.followtoggle.off")),$.logEvent("followHandler.js",181,w+" turned follow announcements off")):r||(r=!0,$.inidb.set("settings","followToggle",r),$.say($.whisperPrefix(w)+$.lang.get("followhandler.followtoggle.on")),$.logEvent("followHandler.js",181,w+" turned follow announcements on"))),g.equalsIgnoreCase("followers")&&$.say($.lang.get("followhandler.followers",$.getFollows($.channelName))),g.equalsIgnoreCase("checkfollow")){if(!h||""==h)return void $.say($.whisperPrefix(w)+$.lang.get("followhandler.check.usage"));h=h.toLowerCase(),$.user.isFollower(h)?$.say($.lang.get("followhandler.check.follows",$.username.resolve(h))):$.say($.lang.get("followhandler.check.notfollows",$.username.resolve(h)))}return g.equalsIgnoreCase("follow")||g.equalsIgnoreCase("shoutout")||g.equalsIgnoreCase("caster")?h&&""!=h?(l=$.username.resolve(d[0]),o=$.getGame(l),s="http://twitch.tv/"+l,null==o||""==o?void $.say($.whisperPrefix(w)+$.lang.get("followhandler.shoutout.404",d[0])):($.isOnline(l)?(i=$.lang.get("followhandler.shoutout.online",l,s,o),$.logEvent("followHandler.js",181,w+" shouted out streamer "+l)):(i=$.lang.get("followhandler.shoutout.offline",l,s,o),$.logEvent("followHandler.js",181,w+" shouted out streamer "+l)),void $.say(i))):void $.say($.whisperPrefix(w)+$.lang.get("followhandler.shoutout.usage",g.toLowerCase())):void 0}),$.bind("initReady",function(){$.bot.isModuleEnabled("./handlers/followHandler.js")&&($.registerChatCommand("./handlers/followHandler.js","followreward",1),$.registerChatCommand("./handlers/followHandler.js","followtoggle",1),$.registerChatCommand("./handlers/followHandler.js","followmessage",1),$.registerChatCommand("./handlers/followHandler.js","followmessagenoreward",1),$.registerChatCommand("./handlers/followHandler.js","checkfollow",2),$.registerChatCommand("./handlers/followHandler.js","followers",7),$.registerChatCommand("./handlers/followHandler.js","follow",2),$.registerChatCommand("./handlers/followHandler.js","shoutout",2),$.registerChatCommand("./handlers/followHandler.js","caster",2))})}();
