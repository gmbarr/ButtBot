!function(){var e=$.inidb.exists("subscribeHandler","subscribeMessage")?$.inidb.get("subscribeHandler","subscribeMessage"):"(name) just subscribed!",s=$.inidb.exists("subscribeHandler","reSubscribeMessage")?$.inidb.get("subscribeHandler","reSubscribeMessage"):"(name) just subscribed for (months) months in a row!",r=$.inidb.exists("subscribeHandler","subscriberWelcomeToggle")?$.getIniDbBoolean("subscribeHandler","subscriberWelcomeToggle"):!0,i=$.inidb.exists("subscribeHandler","reSubscriberWelcomeToggle")?$.getIniDbBoolean("subscribeHandler","reSubscriberWelcomeToggle"):!0,b=parseInt($.inidb.exists("subscribeHandler","subscribeReward"))?parseInt($.inidb.get("subscribeHandler","subscribeReward")):0;$.bind("twitchSubscribesInitialized",function(){$.bot.isModuleEnabled("./handlers/subscribeHandler.js")&&$.consoleLn(">> Enabling subscriber announcements")}),$.bind("twitchSubscribe",function(e){if($.bot.isModuleEnabled("./handlers/subscribeHandler.js")){var s=e.getSubscriber();$.inidb.exists("subscribed",s)?b>0&&$.bot.isModuleEnabled("./core/pointSystem.js")&&$.inidb.incr("points",s,b):$.inidb.set("subscribed",s,"true")}}),$.bind("twitchUnsubscribe",function(e){if($.bot.isModuleEnabled("./handlers/subscribeHandler.js")){var s=e.getSubscriber();$.inidb.exists("subscribed",s)&&$.inidb.del("subscribed",s)}}),$.bind("command",function(i){var n=i.getSender(),a=i.getCommand(),d=i.getArguments().trim(),t=i.getArgs();if(a.equalsIgnoreCase("subwelcometoggle"))return $.isAdmin(n)?r?($.inidb.set("subscribeHandler","subscriberWelcomeToggle",!1),r=!1,void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.new.sub.toggle.off"))):($.inidb.set("subscribeHandler","subscriberWelcomeToggle",!0),r=!0,void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.new.sub.toggle.on"))):void $.say($.whisperPrefix(n)+$.adminMsg);if(a.equalsIgnoreCase("resubwelcometoggle"))return $.isAdmin(n)?r?($.inidb.set("subscribeHandler","reSubscriberWelcomeToggle",!1),r=!1,void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.resub.toggle.off"))):($.inidb.set("subscribeHandler","reSubscriberWelcomeToggle",!0),r=!0,void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.resub.toggle.on"))):void $.say($.whisperPrefix(n)+$.adminMsg);if(a.equalsIgnoreCase("submessage"))return $.isAdmin(n)?0==t.length?void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.sub.msg.usage")):($.inidb.set("subscribeHandler","subscribeMessage",d),e=d,void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.sub.msg.set"))):void $.say($.whisperPrefix(n)+$.adminMsg);if(a.equalsIgnoreCase("resubmessage"))return $.isAdmin(n)?0==t.length?void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.resub.msg.usage")):($.inidb.set("subscribeHandler","reSubscribeMessage",d),s=d,void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.resub.msg.set"))):void $.say($.whisperPrefix(n)+$.adminMsg);if(a.equalsIgnoreCase("subscribereward"))return $.isAdmin(n)?0==t.length?void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.reward.usage")):($.inidb.set("subscribeHandler","subscribeReward",parseInt(t[0])),b=parseInt(t[0]),void $.say($.whisperPrefix(n)+$.lang.get("subscribehandler.reward.set"))):void $.say($.whisperPrefix(n)+$.adminMsg);if(a.equalsIgnoreCase("subscribercount")){if(!$.isAdmin(n))return void $.say($.whisperPrefix(n)+$.adminMsg);var u,g=$.inidb.GetKeyList("subscribed",""),o=0;for(u=0;u<g.length;u++)o++;$.say($.whisperPrefix(n)+$.lang.get("subscribehandler.sub.count",o))}if(a.equalsIgnoreCase("subscribers")){if(!$.isModv3(n,i.getTags()))return void $.say($.whisperPrefix(n)+$.modMsg);$.say(".subscribers")}if(a.equalsIgnoreCase("subscribersoff")){if(!$.isModv3(n,i.getTags()))return void $.say($.whisperPrefix(n)+$.modMsg);$.say(".subscribersoff")}}),$.bind("ircPrivateMessage",function(n){var a=n.getSender(),d=n.getMessage(),t=e,u=s,g=d.substring(0,d.indexOf(" ",1)).toString();if(a.equalsIgnoreCase("twitchnotify")){if(d.contains("just subscribed!")&&r)return t=t.replace(/\(name\)/gi,g),t=t.replace(/\(reward\)/gi,b.toString()),void $.say(t);if(d.contains("months in a row!")&&d.contains("subscribed for")&&i){var o=d.substring(d.indexOf("months")-3,d.indexOf("months")-1).toString();u=u.replace(/\(name\)/gi,g),u=u.replace(/\(months\)/gi,o),u=u.replace(/\(reward\)/gi,b.toString()),$.say(u)}}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./handlers/subscribehandler.js")&&($.registerChatCommand("./handlers/subscribehandler.js","subwelcometoggle",2),$.registerChatCommand("./handlers/subscribehandler.js","resubwelcometoggle",2),$.registerChatCommand("./handlers/subscribehandler.js","subscribereward",2),$.registerChatCommand("./handlers/subscribehandler.js","subscribercount",2),$.registerChatCommand("./handlers/subscribehandler.js","submessage",2),$.registerChatCommand("./handlers/subscribehandler.js","resubmessage",2),$.registerChatCommand("./handlers/subscribehandler.js","subscribers",2),$.registerChatCommand("./handlers/subscribehandler.js","subscribersoff",2))})}();
