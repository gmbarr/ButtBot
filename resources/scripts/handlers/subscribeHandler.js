!function(){var e=$.inidb.exists("subscribeHandler","subscribeMessage")?$.inidb.get("subscribeHandler","subscribeMessage"):"(name) just subscribed!",s=$.inidb.exists("subscribeHandler","reSubscribeMessage")?$.inidb.get("subscribeHandler","reSubscribeMessage"):"(name) just subscribed for (months) months in a row!",r=$.inidb.exists("subscribeHandler","subscribeMessageNoReward")?$.inidb.get("subscribeHandler","subscribeMessageNoReward"):"(name) just subscribed!",i=$.inidb.exists("subscribeHandler","reSubscribeMessageNoReward")?$.inidb.get("subscribeHandler","reSubscribeMessageNoReward"):"(name) just subscribed for (months) months in a row!",b=$.inidb.exists("subscribeHandler","subscriberWelcomeToggle")?$.getIniDbBoolean("subscribeHandler","subscriberWelcomeToggle"):!0,n=$.inidb.exists("subscribeHandler","reSubscriberWelcomeToggle")?$.getIniDbBoolean("subscribeHandler","reSubscriberWelcomeToggle"):!0,a=parseInt($.inidb.exists("subscribeHandler","subscribeReward"))?parseInt($.inidb.get("subscribeHandler","subscribeReward")):0;$.bind("twitchSubscribesInitialized",function(){$.bot.isModuleEnabled("./handlers/subscribeHandler.js")&&$.consoleLn(">> Enabling subscriber announcements")}),$.bind("twitchSubscribe",function(e){if($.bot.isModuleEnabled("./handlers/subscribeHandler.js")){var s=e.getSubscriber();$.inidb.exists("subscribed",s)?a>0&&$.bot.isModuleEnabled("./core/pointSystem.js")&&$.inidb.incr("points",s,a):$.inidb.set("subscribed",s,"true")}}),$.bind("twitchUnsubscribe",function(e){if($.bot.isModuleEnabled("./handlers/subscribeHandler.js")){var s=e.getSubscriber();$.inidb.exists("subscribed",s)&&$.inidb.del("subscribed",s)}}),$.bind("command",function(r){var i=r.getSender(),n=r.getCommand(),d=r.getArguments().trim(),u=r.getArgs();if(n.equalsIgnoreCase("subwelcometoggle"))return $.isAdmin(i)?b?($.inidb.set("subscribeHandler","subscriberWelcomeToggle",!1),b=!1,void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.new.sub.toggle.off"))):($.inidb.set("subscribeHandler","subscriberWelcomeToggle",!0),b=!0,void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.new.sub.toggle.on"))):void $.say($.whisperPrefix(i)+$.adminMsg);if(n.equalsIgnoreCase("resubwelcometoggle"))return $.isAdmin(i)?b?($.inidb.set("subscribeHandler","reSubscriberWelcomeToggle",!1),b=!1,void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.resub.toggle.off"))):($.inidb.set("subscribeHandler","reSubscriberWelcomeToggle",!0),b=!0,void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.resub.toggle.on"))):void $.say($.whisperPrefix(i)+$.adminMsg);if(n.equalsIgnoreCase("submessage"))return $.isAdmin(i)?0==u.length?void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.sub.msg.usage")):($.inidb.set("subscribeHandler","subscribeMessage",d),e=d,void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.sub.msg.set"))):void $.say($.whisperPrefix(i)+$.adminMsg);if(n.equalsIgnoreCase("resubmessage"))return $.isAdmin(i)?0==u.length?void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.resub.msg.usage")):($.inidb.set("subscribeHandler","reSubscribeMessage",d),s=d,void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.resub.msg.set"))):void $.say($.whisperPrefix(i)+$.adminMsg);if(n.equalsIgnoreCase("submessagenoreward"))return $.isAdmin(i)?0==u.length?void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.sub.msg.usage")):($.inidb.set("subscribeHandler","subscribeMessageNoReward",d),e=d,void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.sub.msg.set"))):void $.say($.whisperPrefix(i)+$.adminMsg);if(n.equalsIgnoreCase("resubmessagenoreward"))return $.isAdmin(i)?0==u.length?void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.resub.msg.noreward.usage")):($.inidb.set("subscribeHandler","reSubscribeMessageNoReward",d),s=d,void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.resub.msg.noreward.set"))):void $.say($.whisperPrefix(i)+$.adminMsg);if(n.equalsIgnoreCase("subscribereward"))return $.isAdmin(i)?0==u.length?void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.reward.usage")):($.inidb.set("subscribeHandler","subscribeReward",parseInt(u[0])),a=parseInt(u[0]),void $.say($.whisperPrefix(i)+$.lang.get("subscribehandler.reward.set"))):void $.say($.whisperPrefix(i)+$.adminMsg);if(n.equalsIgnoreCase("subscribercount")){if(!$.isAdmin(i))return void $.say($.whisperPrefix(i)+$.adminMsg);var t,g=$.inidb.GetKeyList("subscribed",""),o=0;for(t=0;t<g.length;t++)o++;$.say($.whisperPrefix(i)+$.lang.get("subscribehandler.sub.count",o))}if(n.equalsIgnoreCase("subscribers")){if(!$.isModv3(i,r.getTags()))return void $.say($.whisperPrefix(i)+$.modMsg);$.say(".subscribers")}if(n.equalsIgnoreCase("subscribersoff")){if(!$.isModv3(i,r.getTags()))return void $.say($.whisperPrefix(i)+$.modMsg);$.say(".subscribersoff")}}),$.bind("ircPrivateMessage",function(d){var u,t,g=d.getSender(),o=d.getMessage(),l=o.substring(0,o.indexOf(" ",1)).toString();if(u=a>0&&$.bot.isModuleEnabled("./systems/pointSystem.js")?e:r,t=a>0&&$.bot.isModuleEnabled("./systems/pointSystem.js")?s:i,g.equalsIgnoreCase("twitchnotify")){if(o.contains("just subscribed!")&&b)return u=u.replace(/\(name\)/gi,l),u=u.replace(/\(reward\)/gi,a.toString()),void $.say(u);if(o.contains("months in a row!")&&o.contains("subscribed for")&&n){var c=o.substring(o.indexOf("months")-3,o.indexOf("months")-1).toString();t=t.replace(/\(name\)/gi,l),t=t.replace(/\(months\)/gi,c),t=t.replace(/\(reward\)/gi,a.toString()),$.say(t)}}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./handlers/subscribehandler.js")&&($.registerChatCommand("./handlers/subscribehandler.js","subwelcometoggle",2),$.registerChatCommand("./handlers/subscribehandler.js","resubwelcometoggle",2),$.registerChatCommand("./handlers/subscribehandler.js","subscribereward",2),$.registerChatCommand("./handlers/subscribehandler.js","subscribercount",2),$.registerChatCommand("./handlers/subscribehandler.js","submessage",2),$.registerChatCommand("./handlers/subscribehandler.js","submessagenoreward",2),$.registerChatCommand("./handlers/subscribehandler.js","resubmessage",2),$.registerChatCommand("./handlers/subscribehandler.js","resubmessagenoreward",2),$.registerChatCommand("./handlers/subscribehandler.js","subscribers",2),$.registerChatCommand("./handlers/subscribehandler.js","subscribersoff",2))})}();
