(function(){var e=$.inidb.exists("subscribeHandler","subscribeMessage")?$.inidb.get("subscribeHandler","subscribeMessage"):"(name) just subscribed!",s=$.inidb.exists("subscribeHandler","reSubscribeMessage")?$.inidb.get("subscribeHandler","reSubscribeMessage"):"(name) just subscribed for (months) months in a row!",r=$.inidb.exists("subscribeHandler","subscriberWelcomeToggle")?$.getIniDbBoolean("subscribeHandler","subscriberWelcomeToggle"):true,i=$.inidb.exists("subscribeHandler","reSubscriberWelcomeToggle")?$.getIniDbBoolean("subscribeHandler","reSubscriberWelcomeToggle"):true,n=parseInt($.inidb.exists("subscribeHandler","subscribeReward"))?parseInt($.inidb.get("subscribeHandler","subscribeReward")):0;$.bind("twitchSubscribesInitialized",function(){if(!$.bot.isModuleEnabled("./handlers/subsribeHandler.js")){return}$.consoleLn(">> Enabling subscriber announcements")});$.bind("twitchSubscribe",function(e){if(!$.bot.isModuleEnabled("./handlers/subsribeHandler.js")){return}var s=e.getSubscriber();if(!$.inidb.exists("subscribed",s)){$.inidb.set("subscribed",s,"true")}else if(n>0&&$.bot.isModuleEnabled("./core/pointSystem.js")){$.inidb.incr("points",s,n)}});$.bind("twitchUnsubscribe",function(e){if(!$.bot.isModuleEnabled("./handlers/subsribeHandler.js")){return}var s=e.getSubscriber();if($.inidb.exists("subscribed",s)){$.inidb.del("subscribed",s)}});$.bind("command",function(i){var b=i.getSender(),a=i.getCommand(),u=i.getArguments().trim(),t=i.getArgs();if(a.equalsIgnoreCase("subwelcometoggle")){if(!$.isAdmin(b)){$.say($.whisperPrefix(b)+$.adminMsg);return}if(r){$.inidb.set("subscribeHandler","subscriberWelcomeToggle",false);r=false;$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.new.sub.toggle.off"));return}else{$.inidb.set("subscribeHandler","subscriberWelcomeToggle",true);r=true;$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.new.sub.toggle.on"));return}}if(a.equalsIgnoreCase("resubwelcometoggle")){if(!$.isAdmin(b)){$.say($.whisperPrefix(b)+$.adminMsg);return}if(r){$.inidb.set("subscribeHandler","reSubscriberWelcomeToggle",false);r=false;$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.resub.toggle.off"));return}else{$.inidb.set("subscribeHandler","reSubscriberWelcomeToggle",true);r=true;$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.resub.toggle.on"));return}}if(a.equalsIgnoreCase("submessage")){if(!$.isAdmin(b)){$.say($.whisperPrefix(b)+$.adminMsg);return}else if(t.length==0){$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.sub.msg.usage"));return}$.inidb.set("subscribeHandler","subscribeMessage",u);e=u;$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.sub.msg.set"));return}if(a.equalsIgnoreCase("resubmessage")){if(!$.isAdmin(b)){$.say($.whisperPrefix(b)+$.adminMsg);return}else if(t.length==0){$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.resub.msg.usage"));return}$.inidb.set("subscribeHandler","reSubscribeMessage",u);s=u;$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.resub.msg.set"));return}if(a.equalsIgnoreCase("subscribereward")){if(!$.isAdmin(b)){$.say($.whisperPrefix(b)+$.adminMsg);return}else if(t.length==0){$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.reward.usage"));return}$.inidb.set("subscribeHandler","subscribeReward",parseInt(t[0]));n=parseInt(t[0]);$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.reward.set"));return}if(a.equalsIgnoreCase("subscribercount")){if(!$.isAdmin(b)){$.say($.whisperPrefix(b)+$.adminMsg);return}var d=$.inidb.GetKeyList("subscribed",""),l=0,g;for(g=0;g<d.length;g++){l++}$.say($.whisperPrefix(b)+$.lang.get("subscribehandler.sub.count",l))}if(a.equalsIgnoreCase("subscribers")){if(!$.isModv3(b,i.getTags())){$.say($.whisperPrefix(b)+$.modMsg);return}$.say(".subscribers")}if(a.equalsIgnoreCase("subscribersoff")){if(!$.isModv3(b,i.getTags())){$.say($.whisperPrefix(b)+$.modMsg);return}$.say(".subscribersoff")}});$.bind("ircPrivateMessage",function(b){var a=b.getSender(),u=b.getMessage(),t=e,d=s,l=u.substring(0,u.indexOf(" ",1)).toString();if(a.equalsIgnoreCase("twitchnotify")){if(u.contains("just subscribed!")&&r){t=t.replace(/\(name\)/gi,l);t=t.replace("/(reward)/ig",n);$.say(t);return}if(u.contains("months in a row!")&&u.contains("subscribed for")&&i){var g=u.substring(u.indexOf("months")-3,u.indexOf("months")-1).toString();d=d.replace("/(name)/ig",l);d=d.replace("/(months)/ig",g);d=d.replace("/(reward)/ig",n);$.say(d)}}});$.bind("initReady",function(){if($.bot.isModuleEnabled("./handlers/subscribehandler.js")){$.registerChatCommand("./handlers/subscribehandler.js","subwelcometoggle",2);$.registerChatCommand("./handlers/subscribehandler.js","resubwelcometoggle",2);$.registerChatCommand("./handlers/subscribehandler.js","subscribereward",2);$.registerChatCommand("./handlers/subscribehandler.js","subscribecount",2);$.registerChatCommand("./handlers/subscribehandler.js","submessage",2);$.registerChatCommand("./handlers/subscribehandler.js","resubmessage",2);$.registerChatCommand("./handlers/subscribehandler.js","subscribers",2);$.registerChatCommand("./handlers/subscribehandler.js","subscribersoff",2)}})})();
